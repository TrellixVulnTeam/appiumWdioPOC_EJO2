"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

require("source-map-support/register");

var _lib = require("../../../lib");

var _mockRequest = _interopRequireDefault(require("./mock-request"));

var _errors = require("../../../lib/protocol/errors");

var _helpers = require("../../helpers");

function buildReqRes(url, method, body) {
  let req = {
    originalUrl: url,
    method,
    body
  };
  let res = {};
  res.headers = {};

  res.set = (k, v) => {
    res[k] = v;
  };

  res.status = code => {
    res.sentCode = code;
    return res;
  };

  res.send = body => {
    try {
      body = JSON.parse(body);
    } catch (e) {}

    res.sentBody = body;
  };

  return [req, res];
}

describe('proxy', function () {
  let port;

  function mockProxy(opts = {}) {
    opts = {
      server: _helpers.TEST_HOST,
      port,
      ...opts
    };
    let proxy = new _lib.JWProxy(opts);

    proxy.request = async function (...args) {
      return await (0, _mockRequest.default)(...args);
    };

    return proxy;
  }

  before(async function () {
    port = await (0, _helpers.getTestPort)();
  });
  it('should override default params', function () {
    let j = mockProxy({
      server: '127.0.0.2',
      port
    });
    j.server.should.equal('127.0.0.2');
    j.port.should.equal(port);
  });
  it('should save session id on session creation', async function () {
    let j = mockProxy();
    let [res, body] = await j.proxy('/session', 'POST', {
      desiredCapabilities: {}
    });
    res.statusCode.should.equal(200);
    body.should.eql({
      status: 0,
      sessionId: '123',
      value: {
        browserName: 'boo'
      }
    });
    j.sessionId.should.equal('123');
  });
  describe('getUrlForProxy', function () {
    it('should modify session id, host, and port', function () {
      let j = mockProxy({
        sessionId: '123'
      });
      j.getUrlForProxy('http://host.com:1234/session/456/element/200/value').should.eql(`http://${_helpers.TEST_HOST}:${port}/session/123/element/200/value`);
    });
    it('should prepend scheme, host and port if not provided', function () {
      let j = mockProxy({
        sessionId: '123'
      });
      j.getUrlForProxy('/session/456/element/200/value').should.eql(`http://${_helpers.TEST_HOST}:${port}/session/123/element/200/value`);
    });
    it('should respect nonstandard incoming request base path', function () {
      let j = mockProxy({
        sessionId: '123',
        reqBasePath: ''
      });
      j.getUrlForProxy('/session/456/element/200/value').should.eql(`http://${_helpers.TEST_HOST}:${port}/session/123/element/200/value`);
      j = mockProxy({
        sessionId: '123',
        reqBasePath: '/my/base/path'
      });
      j.getUrlForProxy('/my/base/path/session/456/element/200/value').should.eql(`http://${_helpers.TEST_HOST}:${port}/session/123/element/200/value`);
    });
    it('should work with urls which do not have session ids', function () {
      let j = mockProxy({
        sessionId: '123'
      });
      j.getUrlForProxy('http://host.com:1234/session').should.eql(`http://${_helpers.TEST_HOST}:${port}/session`);
      let newUrl = j.getUrlForProxy('/session');
      newUrl.should.eql(`http://${_helpers.TEST_HOST}:${port}/session`);
    });
    it('should throw an error if url requires a sessionId but its null', function () {
      let j = mockProxy();
      let e;

      try {
        j.getUrlForProxy('/session/456/element/200/value');
      } catch (err) {
        e = err;
      }

      should.exist(e);
      e.message.should.contain('without session id');
    });
    it('should not throw an error if url does not require a session id and its null', function () {
      let j = mockProxy();
      let newUrl = j.getUrlForProxy('/status');
      should.exist(newUrl);
    });
  });
  describe('straight proxy', function () {
    it('should successfully proxy straight', async function () {
      let j = mockProxy();
      let [res, body] = await j.proxy('/status', 'GET');
      res.statusCode.should.equal(200);
      body.should.eql({
        status: 0,
        value: {
          foo: 'bar'
        }
      });
    });
    it('should pass along request errors', function () {
      let j = mockProxy({
        sessionId: '123'
      });
      j.proxy('/badurl', 'GET').should.eventually.be.rejectedWith('Could not proxy');
    });
    it('should proxy error responses and codes', async function () {
      let j = mockProxy({
        sessionId: '123'
      });

      try {
        await j.proxy('/element/bad/text', 'GET');
      } catch (e) {
        (0, _errors.isErrorType)(e.getActualError(), _errors.errors.ElementNotVisibleError).should.be.true;
      }
    });
  });
  describe('command proxy', function () {
    it('should successfully proxy command', async function () {
      let j = mockProxy();
      let res = await j.command('/status', 'GET');
      res.should.eql({
        foo: 'bar'
      });
    });
    it('should pass along request errors', function () {
      let j = mockProxy({
        sessionId: '123'
      });
      j.command('/badurl', 'GET').should.eventually.be.rejectedWith('Could not proxy');
    });
    it('should throw when a command fails', async function () {
      let j = mockProxy({
        sessionId: '123'
      });
      let e = null;

      try {
        await j.command('/element/bad/text', 'GET');
      } catch (err) {
        e = err;
      }

      should.exist(e);
      e.message.should.contain('Invisible element');
    });
    it('should throw when a command fails with a 200 because the status is not 0', async function () {
      let j = mockProxy({
        sessionId: '123'
      });
      let e = null;

      try {
        await j.command('/element/200/text', 'GET');
      } catch (err) {
        e = err;
      }

      should.exist(e);
      e.error.should.eql('element not visible');
    });
    it('should throw when a command fails with a 100', async function () {
      let j = mockProxy({
        sessionId: '123'
      });
      let e = null;

      try {
        await j.command('/session/badchrome/nochrome', 'GET');
      } catch (err) {
        e = err;
      }

      should.exist(e);
      e.message.should.contain('chrome not reachable');
    });
  });
  describe('req/res proxy', function () {
    it('should successfully proxy via req and send to res', async function () {
      let j = mockProxy();
      let [req, res] = buildReqRes('/status', 'GET');
      await j.proxyReqRes(req, res);
      res.headers['content-type'].should.equal('application/json; charset=utf-8');
      res.sentCode.should.equal(200);
      res.sentBody.should.eql({
        value: {
          foo: 'bar'
        }
      });
    });
    it('should rewrite the inner session id so it doesnt change', async function () {
      let j = mockProxy({
        sessionId: '123'
      });
      let [req, res] = buildReqRes('/element/200/value', 'GET');
      await j.proxyReqRes(req, res);
      res.sentBody.should.eql({
        value: 'foobar',
        sessionId: '123'
      });
    });
    it('should rewrite the inner session id with sessionId in url', async function () {
      let j = mockProxy({
        sessionId: '123'
      });
      let [req, res] = buildReqRes('/session/456/element/200/value', 'POST');
      await j.proxyReqRes(req, res);
      res.sentBody.should.eql({
        value: 'foobar',
        sessionId: '456'
      });
    });
    it('should pass through urls that do not require session IDs', async function () {
      let j = mockProxy({
        sessionId: '123'
      });
      let [req, res] = buildReqRes('/status', 'GET');
      await j.proxyReqRes(req, res);
      res.sentBody.should.eql({
        value: {
          foo: 'bar'
        }
      });
    });
    it('should proxy strange responses', async function () {
      let j = mockProxy({
        sessionId: '123'
      });
      let [req, res] = buildReqRes('/nochrome', 'GET');
      await j.proxyReqRes(req, res);
      res.sentCode.should.equal(100);
      res.sentBody.should.eql({
        value: {
          message: 'chrome not reachable'
        }
      });
    });
  });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJidWlsZFJlcVJlcyIsInVybCIsIm1ldGhvZCIsImJvZHkiLCJyZXEiLCJvcmlnaW5hbFVybCIsInJlcyIsImhlYWRlcnMiLCJzZXQiLCJrIiwidiIsInN0YXR1cyIsImNvZGUiLCJzZW50Q29kZSIsInNlbmQiLCJKU09OIiwicGFyc2UiLCJlIiwic2VudEJvZHkiLCJkZXNjcmliZSIsInBvcnQiLCJtb2NrUHJveHkiLCJvcHRzIiwic2VydmVyIiwiVEVTVF9IT1NUIiwicHJveHkiLCJKV1Byb3h5IiwicmVxdWVzdCIsImFyZ3MiLCJiZWZvcmUiLCJnZXRUZXN0UG9ydCIsIml0IiwiaiIsInNob3VsZCIsImVxdWFsIiwiZGVzaXJlZENhcGFiaWxpdGllcyIsInN0YXR1c0NvZGUiLCJlcWwiLCJzZXNzaW9uSWQiLCJ2YWx1ZSIsImJyb3dzZXJOYW1lIiwiZ2V0VXJsRm9yUHJveHkiLCJyZXFCYXNlUGF0aCIsIm5ld1VybCIsImVyciIsImV4aXN0IiwibWVzc2FnZSIsImNvbnRhaW4iLCJmb28iLCJldmVudHVhbGx5IiwiYmUiLCJyZWplY3RlZFdpdGgiLCJpc0Vycm9yVHlwZSIsImdldEFjdHVhbEVycm9yIiwiZXJyb3JzIiwiRWxlbWVudE5vdFZpc2libGVFcnJvciIsInRydWUiLCJjb21tYW5kIiwiZXJyb3IiLCJwcm94eVJlcVJlcyJdLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3Rlc3QvdW5pdC9qc29ud3AtcHJveHkvcHJveHkuc3BlYy5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyB0cmFuc3BpbGU6bW9jaGFcblxuaW1wb3J0IHtKV1Byb3h5fSBmcm9tICcuLi8uLi8uLi9saWInO1xuaW1wb3J0IHJlcXVlc3QgZnJvbSAnLi9tb2NrLXJlcXVlc3QnO1xuaW1wb3J0IHtpc0Vycm9yVHlwZSwgZXJyb3JzfSBmcm9tICcuLi8uLi8uLi9saWIvcHJvdG9jb2wvZXJyb3JzJztcbmltcG9ydCB7Z2V0VGVzdFBvcnQsIFRFU1RfSE9TVH0gZnJvbSAnLi4vLi4vaGVscGVycyc7XG5cbmZ1bmN0aW9uIGJ1aWxkUmVxUmVzKHVybCwgbWV0aG9kLCBib2R5KSB7XG4gIGxldCByZXEgPSB7b3JpZ2luYWxVcmw6IHVybCwgbWV0aG9kLCBib2R5fTtcbiAgbGV0IHJlcyA9IHt9O1xuICByZXMuaGVhZGVycyA9IHt9O1xuICByZXMuc2V0ID0gKGssIHYpID0+IHtcbiAgICByZXNba10gPSB2O1xuICB9O1xuICByZXMuc3RhdHVzID0gKGNvZGUpID0+IHtcbiAgICByZXMuc2VudENvZGUgPSBjb2RlO1xuICAgIHJldHVybiByZXM7XG4gIH07XG4gIHJlcy5zZW5kID0gKGJvZHkpID0+IHtcbiAgICB0cnkge1xuICAgICAgYm9keSA9IEpTT04ucGFyc2UoYm9keSk7XG4gICAgfSBjYXRjaCAoZSkge31cbiAgICByZXMuc2VudEJvZHkgPSBib2R5O1xuICB9O1xuICByZXR1cm4gW3JlcSwgcmVzXTtcbn1cblxuZGVzY3JpYmUoJ3Byb3h5JywgZnVuY3Rpb24gKCkge1xuICBsZXQgcG9ydDtcblxuICBmdW5jdGlvbiBtb2NrUHJveHkob3B0cyA9IHt9KSB7XG4gICAgLy8gc2V0cyBkZWZhdWx0IHNlcnZlci9wb3J0XG4gICAgb3B0cyA9IHtzZXJ2ZXI6IFRFU1RfSE9TVCwgcG9ydCwgLi4ub3B0c307XG4gICAgbGV0IHByb3h5ID0gbmV3IEpXUHJveHkob3B0cyk7XG4gICAgcHJveHkucmVxdWVzdCA9IGFzeW5jIGZ1bmN0aW9uICguLi5hcmdzKSB7XG4gICAgICByZXR1cm4gYXdhaXQgcmVxdWVzdCguLi5hcmdzKTtcbiAgICB9O1xuICAgIHJldHVybiBwcm94eTtcbiAgfVxuXG4gIGJlZm9yZShhc3luYyBmdW5jdGlvbiAoKSB7XG4gICAgcG9ydCA9IGF3YWl0IGdldFRlc3RQb3J0KCk7XG4gIH0pO1xuXG4gIGl0KCdzaG91bGQgb3ZlcnJpZGUgZGVmYXVsdCBwYXJhbXMnLCBmdW5jdGlvbiAoKSB7XG4gICAgbGV0IGogPSBtb2NrUHJveHkoe3NlcnZlcjogJzEyNy4wLjAuMicsIHBvcnR9KTtcbiAgICBqLnNlcnZlci5zaG91bGQuZXF1YWwoJzEyNy4wLjAuMicpO1xuICAgIGoucG9ydC5zaG91bGQuZXF1YWwocG9ydCk7XG4gIH0pO1xuICBpdCgnc2hvdWxkIHNhdmUgc2Vzc2lvbiBpZCBvbiBzZXNzaW9uIGNyZWF0aW9uJywgYXN5bmMgZnVuY3Rpb24gKCkge1xuICAgIGxldCBqID0gbW9ja1Byb3h5KCk7XG4gICAgbGV0IFtyZXMsIGJvZHldID0gYXdhaXQgai5wcm94eSgnL3Nlc3Npb24nLCAnUE9TVCcsIHtcbiAgICAgIGRlc2lyZWRDYXBhYmlsaXRpZXM6IHt9LFxuICAgIH0pO1xuICAgIHJlcy5zdGF0dXNDb2RlLnNob3VsZC5lcXVhbCgyMDApO1xuICAgIGJvZHkuc2hvdWxkLmVxbCh7c3RhdHVzOiAwLCBzZXNzaW9uSWQ6ICcxMjMnLCB2YWx1ZToge2Jyb3dzZXJOYW1lOiAnYm9vJ319KTtcbiAgICBqLnNlc3Npb25JZC5zaG91bGQuZXF1YWwoJzEyMycpO1xuICB9KTtcbiAgZGVzY3JpYmUoJ2dldFVybEZvclByb3h5JywgZnVuY3Rpb24gKCkge1xuICAgIGl0KCdzaG91bGQgbW9kaWZ5IHNlc3Npb24gaWQsIGhvc3QsIGFuZCBwb3J0JywgZnVuY3Rpb24gKCkge1xuICAgICAgbGV0IGogPSBtb2NrUHJveHkoe3Nlc3Npb25JZDogJzEyMyd9KTtcbiAgICAgIGouZ2V0VXJsRm9yUHJveHkoJ2h0dHA6Ly9ob3N0LmNvbToxMjM0L3Nlc3Npb24vNDU2L2VsZW1lbnQvMjAwL3ZhbHVlJykuc2hvdWxkLmVxbChcbiAgICAgICAgYGh0dHA6Ly8ke1RFU1RfSE9TVH06JHtwb3J0fS9zZXNzaW9uLzEyMy9lbGVtZW50LzIwMC92YWx1ZWBcbiAgICAgICk7XG4gICAgfSk7XG4gICAgaXQoJ3Nob3VsZCBwcmVwZW5kIHNjaGVtZSwgaG9zdCBhbmQgcG9ydCBpZiBub3QgcHJvdmlkZWQnLCBmdW5jdGlvbiAoKSB7XG4gICAgICBsZXQgaiA9IG1vY2tQcm94eSh7c2Vzc2lvbklkOiAnMTIzJ30pO1xuICAgICAgai5nZXRVcmxGb3JQcm94eSgnL3Nlc3Npb24vNDU2L2VsZW1lbnQvMjAwL3ZhbHVlJykuc2hvdWxkLmVxbChcbiAgICAgICAgYGh0dHA6Ly8ke1RFU1RfSE9TVH06JHtwb3J0fS9zZXNzaW9uLzEyMy9lbGVtZW50LzIwMC92YWx1ZWBcbiAgICAgICk7XG4gICAgfSk7XG4gICAgaXQoJ3Nob3VsZCByZXNwZWN0IG5vbnN0YW5kYXJkIGluY29taW5nIHJlcXVlc3QgYmFzZSBwYXRoJywgZnVuY3Rpb24gKCkge1xuICAgICAgbGV0IGogPSBtb2NrUHJveHkoe3Nlc3Npb25JZDogJzEyMycsIHJlcUJhc2VQYXRoOiAnJ30pO1xuICAgICAgai5nZXRVcmxGb3JQcm94eSgnL3Nlc3Npb24vNDU2L2VsZW1lbnQvMjAwL3ZhbHVlJykuc2hvdWxkLmVxbChcbiAgICAgICAgYGh0dHA6Ly8ke1RFU1RfSE9TVH06JHtwb3J0fS9zZXNzaW9uLzEyMy9lbGVtZW50LzIwMC92YWx1ZWBcbiAgICAgICk7XG5cbiAgICAgIGogPSBtb2NrUHJveHkoe3Nlc3Npb25JZDogJzEyMycsIHJlcUJhc2VQYXRoOiAnL215L2Jhc2UvcGF0aCd9KTtcbiAgICAgIGouZ2V0VXJsRm9yUHJveHkoJy9teS9iYXNlL3BhdGgvc2Vzc2lvbi80NTYvZWxlbWVudC8yMDAvdmFsdWUnKS5zaG91bGQuZXFsKFxuICAgICAgICBgaHR0cDovLyR7VEVTVF9IT1NUfToke3BvcnR9L3Nlc3Npb24vMTIzL2VsZW1lbnQvMjAwL3ZhbHVlYFxuICAgICAgKTtcbiAgICB9KTtcbiAgICBpdCgnc2hvdWxkIHdvcmsgd2l0aCB1cmxzIHdoaWNoIGRvIG5vdCBoYXZlIHNlc3Npb24gaWRzJywgZnVuY3Rpb24gKCkge1xuICAgICAgbGV0IGogPSBtb2NrUHJveHkoe3Nlc3Npb25JZDogJzEyMyd9KTtcbiAgICAgIGouZ2V0VXJsRm9yUHJveHkoJ2h0dHA6Ly9ob3N0LmNvbToxMjM0L3Nlc3Npb24nKS5zaG91bGQuZXFsKFxuICAgICAgICBgaHR0cDovLyR7VEVTVF9IT1NUfToke3BvcnR9L3Nlc3Npb25gXG4gICAgICApO1xuXG4gICAgICBsZXQgbmV3VXJsID0gai5nZXRVcmxGb3JQcm94eSgnL3Nlc3Npb24nKTtcbiAgICAgIG5ld1VybC5zaG91bGQuZXFsKGBodHRwOi8vJHtURVNUX0hPU1R9OiR7cG9ydH0vc2Vzc2lvbmApO1xuICAgIH0pO1xuICAgIGl0KCdzaG91bGQgdGhyb3cgYW4gZXJyb3IgaWYgdXJsIHJlcXVpcmVzIGEgc2Vzc2lvbklkIGJ1dCBpdHMgbnVsbCcsIGZ1bmN0aW9uICgpIHtcbiAgICAgIGxldCBqID0gbW9ja1Byb3h5KCk7XG4gICAgICBsZXQgZTtcbiAgICAgIHRyeSB7XG4gICAgICAgIGouZ2V0VXJsRm9yUHJveHkoJy9zZXNzaW9uLzQ1Ni9lbGVtZW50LzIwMC92YWx1ZScpO1xuICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgIGUgPSBlcnI7XG4gICAgICB9XG4gICAgICBzaG91bGQuZXhpc3QoZSk7XG4gICAgICBlLm1lc3NhZ2Uuc2hvdWxkLmNvbnRhaW4oJ3dpdGhvdXQgc2Vzc2lvbiBpZCcpO1xuICAgIH0pO1xuICAgIGl0KCdzaG91bGQgbm90IHRocm93IGFuIGVycm9yIGlmIHVybCBkb2VzIG5vdCByZXF1aXJlIGEgc2Vzc2lvbiBpZCBhbmQgaXRzIG51bGwnLCBmdW5jdGlvbiAoKSB7XG4gICAgICBsZXQgaiA9IG1vY2tQcm94eSgpO1xuICAgICAgbGV0IG5ld1VybCA9IGouZ2V0VXJsRm9yUHJveHkoJy9zdGF0dXMnKTtcblxuICAgICAgc2hvdWxkLmV4aXN0KG5ld1VybCk7XG4gICAgfSk7XG4gIH0pO1xuICBkZXNjcmliZSgnc3RyYWlnaHQgcHJveHknLCBmdW5jdGlvbiAoKSB7XG4gICAgaXQoJ3Nob3VsZCBzdWNjZXNzZnVsbHkgcHJveHkgc3RyYWlnaHQnLCBhc3luYyBmdW5jdGlvbiAoKSB7XG4gICAgICBsZXQgaiA9IG1vY2tQcm94eSgpO1xuICAgICAgbGV0IFtyZXMsIGJvZHldID0gYXdhaXQgai5wcm94eSgnL3N0YXR1cycsICdHRVQnKTtcbiAgICAgIHJlcy5zdGF0dXNDb2RlLnNob3VsZC5lcXVhbCgyMDApO1xuICAgICAgYm9keS5zaG91bGQuZXFsKHtzdGF0dXM6IDAsIHZhbHVlOiB7Zm9vOiAnYmFyJ319KTtcbiAgICB9KTtcbiAgICBpdCgnc2hvdWxkIHBhc3MgYWxvbmcgcmVxdWVzdCBlcnJvcnMnLCBmdW5jdGlvbiAoKSB7XG4gICAgICBsZXQgaiA9IG1vY2tQcm94eSh7c2Vzc2lvbklkOiAnMTIzJ30pO1xuICAgICAgai5wcm94eSgnL2JhZHVybCcsICdHRVQnKS5zaG91bGQuZXZlbnR1YWxseS5iZS5yZWplY3RlZFdpdGgoJ0NvdWxkIG5vdCBwcm94eScpO1xuICAgIH0pO1xuICAgIGl0KCdzaG91bGQgcHJveHkgZXJyb3IgcmVzcG9uc2VzIGFuZCBjb2RlcycsIGFzeW5jIGZ1bmN0aW9uICgpIHtcbiAgICAgIGxldCBqID0gbW9ja1Byb3h5KHtzZXNzaW9uSWQ6ICcxMjMnfSk7XG4gICAgICB0cnkge1xuICAgICAgICBhd2FpdCBqLnByb3h5KCcvZWxlbWVudC9iYWQvdGV4dCcsICdHRVQnKTtcbiAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgaXNFcnJvclR5cGUoZS5nZXRBY3R1YWxFcnJvcigpLCBlcnJvcnMuRWxlbWVudE5vdFZpc2libGVFcnJvcikuc2hvdWxkLmJlLnRydWU7XG4gICAgICB9XG4gICAgfSk7XG4gIH0pO1xuICBkZXNjcmliZSgnY29tbWFuZCBwcm94eScsIGZ1bmN0aW9uICgpIHtcbiAgICBpdCgnc2hvdWxkIHN1Y2Nlc3NmdWxseSBwcm94eSBjb21tYW5kJywgYXN5bmMgZnVuY3Rpb24gKCkge1xuICAgICAgbGV0IGogPSBtb2NrUHJveHkoKTtcbiAgICAgIGxldCByZXMgPSBhd2FpdCBqLmNvbW1hbmQoJy9zdGF0dXMnLCAnR0VUJyk7XG4gICAgICByZXMuc2hvdWxkLmVxbCh7Zm9vOiAnYmFyJ30pO1xuICAgIH0pO1xuICAgIGl0KCdzaG91bGQgcGFzcyBhbG9uZyByZXF1ZXN0IGVycm9ycycsIGZ1bmN0aW9uICgpIHtcbiAgICAgIGxldCBqID0gbW9ja1Byb3h5KHtzZXNzaW9uSWQ6ICcxMjMnfSk7XG4gICAgICBqLmNvbW1hbmQoJy9iYWR1cmwnLCAnR0VUJykuc2hvdWxkLmV2ZW50dWFsbHkuYmUucmVqZWN0ZWRXaXRoKCdDb3VsZCBub3QgcHJveHknKTtcbiAgICB9KTtcbiAgICBpdCgnc2hvdWxkIHRocm93IHdoZW4gYSBjb21tYW5kIGZhaWxzJywgYXN5bmMgZnVuY3Rpb24gKCkge1xuICAgICAgbGV0IGogPSBtb2NrUHJveHkoe3Nlc3Npb25JZDogJzEyMyd9KTtcbiAgICAgIGxldCBlID0gbnVsbDtcbiAgICAgIHRyeSB7XG4gICAgICAgIGF3YWl0IGouY29tbWFuZCgnL2VsZW1lbnQvYmFkL3RleHQnLCAnR0VUJyk7XG4gICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgZSA9IGVycjtcbiAgICAgIH1cbiAgICAgIHNob3VsZC5leGlzdChlKTtcbiAgICAgIGUubWVzc2FnZS5zaG91bGQuY29udGFpbignSW52aXNpYmxlIGVsZW1lbnQnKTtcbiAgICB9KTtcbiAgICBpdCgnc2hvdWxkIHRocm93IHdoZW4gYSBjb21tYW5kIGZhaWxzIHdpdGggYSAyMDAgYmVjYXVzZSB0aGUgc3RhdHVzIGlzIG5vdCAwJywgYXN5bmMgZnVuY3Rpb24gKCkge1xuICAgICAgbGV0IGogPSBtb2NrUHJveHkoe3Nlc3Npb25JZDogJzEyMyd9KTtcbiAgICAgIGxldCBlID0gbnVsbDtcbiAgICAgIHRyeSB7XG4gICAgICAgIGF3YWl0IGouY29tbWFuZCgnL2VsZW1lbnQvMjAwL3RleHQnLCAnR0VUJyk7XG4gICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgZSA9IGVycjtcbiAgICAgIH1cbiAgICAgIHNob3VsZC5leGlzdChlKTtcbiAgICAgIGUuZXJyb3Iuc2hvdWxkLmVxbCgnZWxlbWVudCBub3QgdmlzaWJsZScpO1xuICAgIH0pO1xuICAgIGl0KCdzaG91bGQgdGhyb3cgd2hlbiBhIGNvbW1hbmQgZmFpbHMgd2l0aCBhIDEwMCcsIGFzeW5jIGZ1bmN0aW9uICgpIHtcbiAgICAgIGxldCBqID0gbW9ja1Byb3h5KHtzZXNzaW9uSWQ6ICcxMjMnfSk7XG4gICAgICBsZXQgZSA9IG51bGw7XG4gICAgICB0cnkge1xuICAgICAgICBhd2FpdCBqLmNvbW1hbmQoJy9zZXNzaW9uL2JhZGNocm9tZS9ub2Nocm9tZScsICdHRVQnKTtcbiAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICBlID0gZXJyO1xuICAgICAgfVxuICAgICAgc2hvdWxkLmV4aXN0KGUpO1xuICAgICAgZS5tZXNzYWdlLnNob3VsZC5jb250YWluKCdjaHJvbWUgbm90IHJlYWNoYWJsZScpO1xuICAgIH0pO1xuICB9KTtcbiAgZGVzY3JpYmUoJ3JlcS9yZXMgcHJveHknLCBmdW5jdGlvbiAoKSB7XG4gICAgaXQoJ3Nob3VsZCBzdWNjZXNzZnVsbHkgcHJveHkgdmlhIHJlcSBhbmQgc2VuZCB0byByZXMnLCBhc3luYyBmdW5jdGlvbiAoKSB7XG4gICAgICBsZXQgaiA9IG1vY2tQcm94eSgpO1xuICAgICAgbGV0IFtyZXEsIHJlc10gPSBidWlsZFJlcVJlcygnL3N0YXR1cycsICdHRVQnKTtcbiAgICAgIGF3YWl0IGoucHJveHlSZXFSZXMocmVxLCByZXMpO1xuICAgICAgcmVzLmhlYWRlcnNbJ2NvbnRlbnQtdHlwZSddLnNob3VsZC5lcXVhbCgnYXBwbGljYXRpb24vanNvbjsgY2hhcnNldD11dGYtOCcpO1xuICAgICAgcmVzLnNlbnRDb2RlLnNob3VsZC5lcXVhbCgyMDApO1xuICAgICAgcmVzLnNlbnRCb2R5LnNob3VsZC5lcWwoe3ZhbHVlOiB7Zm9vOiAnYmFyJ319KTtcbiAgICB9KTtcbiAgICBpdCgnc2hvdWxkIHJld3JpdGUgdGhlIGlubmVyIHNlc3Npb24gaWQgc28gaXQgZG9lc250IGNoYW5nZScsIGFzeW5jIGZ1bmN0aW9uICgpIHtcbiAgICAgIGxldCBqID0gbW9ja1Byb3h5KHtzZXNzaW9uSWQ6ICcxMjMnfSk7XG4gICAgICBsZXQgW3JlcSwgcmVzXSA9IGJ1aWxkUmVxUmVzKCcvZWxlbWVudC8yMDAvdmFsdWUnLCAnR0VUJyk7XG4gICAgICBhd2FpdCBqLnByb3h5UmVxUmVzKHJlcSwgcmVzKTtcbiAgICAgIHJlcy5zZW50Qm9keS5zaG91bGQuZXFsKHt2YWx1ZTogJ2Zvb2JhcicsIHNlc3Npb25JZDogJzEyMyd9KTtcbiAgICB9KTtcbiAgICBpdCgnc2hvdWxkIHJld3JpdGUgdGhlIGlubmVyIHNlc3Npb24gaWQgd2l0aCBzZXNzaW9uSWQgaW4gdXJsJywgYXN5bmMgZnVuY3Rpb24gKCkge1xuICAgICAgbGV0IGogPSBtb2NrUHJveHkoe3Nlc3Npb25JZDogJzEyMyd9KTtcbiAgICAgIGxldCBbcmVxLCByZXNdID0gYnVpbGRSZXFSZXMoJy9zZXNzaW9uLzQ1Ni9lbGVtZW50LzIwMC92YWx1ZScsICdQT1NUJyk7XG4gICAgICBhd2FpdCBqLnByb3h5UmVxUmVzKHJlcSwgcmVzKTtcbiAgICAgIHJlcy5zZW50Qm9keS5zaG91bGQuZXFsKHt2YWx1ZTogJ2Zvb2JhcicsIHNlc3Npb25JZDogJzQ1Nid9KTtcbiAgICB9KTtcbiAgICBpdCgnc2hvdWxkIHBhc3MgdGhyb3VnaCB1cmxzIHRoYXQgZG8gbm90IHJlcXVpcmUgc2Vzc2lvbiBJRHMnLCBhc3luYyBmdW5jdGlvbiAoKSB7XG4gICAgICBsZXQgaiA9IG1vY2tQcm94eSh7c2Vzc2lvbklkOiAnMTIzJ30pO1xuICAgICAgbGV0IFtyZXEsIHJlc10gPSBidWlsZFJlcVJlcygnL3N0YXR1cycsICdHRVQnKTtcbiAgICAgIGF3YWl0IGoucHJveHlSZXFSZXMocmVxLCByZXMpO1xuICAgICAgcmVzLnNlbnRCb2R5LnNob3VsZC5lcWwoe3ZhbHVlOiB7Zm9vOiAnYmFyJ319KTtcbiAgICB9KTtcbiAgICBpdCgnc2hvdWxkIHByb3h5IHN0cmFuZ2UgcmVzcG9uc2VzJywgYXN5bmMgZnVuY3Rpb24gKCkge1xuICAgICAgbGV0IGogPSBtb2NrUHJveHkoe3Nlc3Npb25JZDogJzEyMyd9KTtcbiAgICAgIGxldCBbcmVxLCByZXNdID0gYnVpbGRSZXFSZXMoJy9ub2Nocm9tZScsICdHRVQnKTtcbiAgICAgIGF3YWl0IGoucHJveHlSZXFSZXMocmVxLCByZXMpO1xuICAgICAgcmVzLnNlbnRDb2RlLnNob3VsZC5lcXVhbCgxMDApO1xuICAgICAgcmVzLnNlbnRCb2R5LnNob3VsZC5lcWwoe3ZhbHVlOiB7bWVzc2FnZTogJ2Nocm9tZSBub3QgcmVhY2hhYmxlJ319KTtcbiAgICB9KTtcbiAgfSk7XG59KTtcbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBRUE7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBRUEsU0FBU0EsV0FBVCxDQUFxQkMsR0FBckIsRUFBMEJDLE1BQTFCLEVBQWtDQyxJQUFsQyxFQUF3QztFQUN0QyxJQUFJQyxHQUFHLEdBQUc7SUFBQ0MsV0FBVyxFQUFFSixHQUFkO0lBQW1CQyxNQUFuQjtJQUEyQkM7RUFBM0IsQ0FBVjtFQUNBLElBQUlHLEdBQUcsR0FBRyxFQUFWO0VBQ0FBLEdBQUcsQ0FBQ0MsT0FBSixHQUFjLEVBQWQ7O0VBQ0FELEdBQUcsQ0FBQ0UsR0FBSixHQUFVLENBQUNDLENBQUQsRUFBSUMsQ0FBSixLQUFVO0lBQ2xCSixHQUFHLENBQUNHLENBQUQsQ0FBSCxHQUFTQyxDQUFUO0VBQ0QsQ0FGRDs7RUFHQUosR0FBRyxDQUFDSyxNQUFKLEdBQWNDLElBQUQsSUFBVTtJQUNyQk4sR0FBRyxDQUFDTyxRQUFKLEdBQWVELElBQWY7SUFDQSxPQUFPTixHQUFQO0VBQ0QsQ0FIRDs7RUFJQUEsR0FBRyxDQUFDUSxJQUFKLEdBQVlYLElBQUQsSUFBVTtJQUNuQixJQUFJO01BQ0ZBLElBQUksR0FBR1ksSUFBSSxDQUFDQyxLQUFMLENBQVdiLElBQVgsQ0FBUDtJQUNELENBRkQsQ0FFRSxPQUFPYyxDQUFQLEVBQVUsQ0FBRTs7SUFDZFgsR0FBRyxDQUFDWSxRQUFKLEdBQWVmLElBQWY7RUFD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
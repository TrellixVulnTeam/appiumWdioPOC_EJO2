"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.stubLog = stubLog;

require("source-map-support/register");

function stripColors(msg) {
  let code = /\u001b\[(\d+(;\d+)*)?m/g;
  msg = ('' + msg).replace(code, '');
  return msg;
}

class LogStub {
  constructor(opts = {}) {
    this.output = '';
    this.stripColors = opts.stripColors;
  }

  log(level, message) {
    if (this.stripColors) {
      message = stripColors(message);
    }

    if (this.output.length > 0) {
      this.output += '\n';
    }

    this.output = `${this.output}${level}: ${message}`;
  }

}

function stubLog(sandbox, log, opts = {}) {
  let logStub = new LogStub(opts);

  for (let l of log.levels) {
    sandbox.stub(log, l).callsFake(function doLogging(mess) {
      logStub.log(l, mess);
    });
  }

  return logStub;
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJzdHJpcENvbG9ycyIsIm1zZyIsImNvZGUiLCJyZXBsYWNlIiwiTG9nU3R1YiIsImNvbnN0cnVjdG9yIiwib3B0cyIsIm91dHB1dCIsImxvZyIsImxldmVsIiwibWVzc2FnZSIsImxlbmd0aCIsInN0dWJMb2ciLCJzYW5kYm94IiwibG9nU3R1YiIsImwiLCJsZXZlbHMiLCJzdHViIiwiY2FsbHNGYWtlIiwiZG9Mb2dnaW5nIiwibWVzcyJdLCJzb3VyY2VzIjpbIi4uLy4uL2xpYi9sb2ctdXRpbHMuanMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gVE9ETyBtb3ZlIHRoYXQgdG8gQGFwcGl1bS9zdXBwb3J0XG5mdW5jdGlvbiBzdHJpcENvbG9ycyhtc2cpIHtcbiAgbGV0IGNvZGUgPSAvXFx1MDAxYlxcWyhcXGQrKDtcXGQrKSopP20vZzsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBuby1jb250cm9sLXJlZ2V4XG4gIG1zZyA9ICgnJyArIG1zZykucmVwbGFjZShjb2RlLCAnJyk7XG4gIHJldHVybiBtc2c7XG59XG5cbmNsYXNzIExvZ1N0dWIge1xuICBjb25zdHJ1Y3RvcihvcHRzID0ge30pIHtcbiAgICB0aGlzLm91dHB1dCA9ICcnO1xuICAgIHRoaXMuc3RyaXBDb2xvcnMgPSBvcHRzLnN0cmlwQ29sb3JzO1xuICB9XG4gIGxvZyhsZXZlbCwgbWVzc2FnZSkge1xuICAgIGlmICh0aGlzLnN0cmlwQ29sb3JzKSB7XG4gICAgICBtZXNzYWdlID0gc3RyaXBDb2xvcnMobWVzc2FnZSk7XG4gICAgfVxuICAgIGlmICh0aGlzLm91dHB1dC5sZW5ndGggPiAwKSB7XG4gICAgICB0aGlzLm91dHB1dCArPSAnXFxuJztcbiAgICB9XG4gICAgdGhpcy5vdXRwdXQgPSBgJHt0aGlzLm91dHB1dH0ke2xldmVsfTogJHttZXNzYWdlfWA7XG4gIH1cbn1cblxuZnVuY3Rpb24gc3R1YkxvZyhzYW5kYm94LCBsb2csIG9wdHMgPSB7fSkge1xuICBsZXQgbG9nU3R1YiA9IG5ldyBMb2dTdHViKG9wdHMpO1xuICBmb3IgKGxldCBsIG9mIGxvZy5sZXZlbHMpIHtcbiAgICBzYW5kYm94LnN0dWIobG9nLCBsKS5jYWxsc0Zha2UoZnVuY3Rpb24gZG9Mb2dnaW5nKG1lc3MpIHtcbiAgICAgIGxvZ1N0dWIubG9nKGwsIG1lc3MpO1xuICAgIH0pO1xuICB9XG4gIHJldHVybiBsb2dTdHViO1xufVxuXG5leHBvcnQge3N0dWJMb2d9O1xuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7QUFDQSxTQUFTQSxXQUFULENBQXFCQyxHQUFyQixFQUEwQjtFQUN4QixJQUFJQyxJQUFJLEdBQUcseUJBQVg7RUFDQUQsR0FBRyxHQUFHLENBQUMsS0FBS0EsR0FBTixFQUFXRSxPQUFYLENBQW1CRCxJQUFuQixFQUF5QixFQUF6QixDQUFOO0VBQ0EsT0FBT0QsR0FBUDtBQUNEOztBQUVELE1BQU1HLE9BQU4sQ0FBYztFQUNaQyxXQUFXLENBQUNDLElBQUksR0FBRyxFQUFSLEVBQVk7SUFDckIsS0FBS0MsTUFBTCxHQUFjLEVBQWQ7SUFDQSxLQUFLUCxXQUFMLEdBQW1CTSxJQUFJLENBQUNOLFdBQXhCO0VBQ0Q7O0VBQ0RRLEdBQUcsQ0FBQ0MsS0FBRCxFQUFRQyxPQUFSLEVBQWlCO0lBQ2xCLElBQUksS0FBS1YsV0FBVCxFQUFzQjtNQUNwQlUsT0FBTyxHQUFHVixXQUFXLENBQUNVLE9BQUQsQ0FBckI7SUFDRDs7SUFDRCxJQUFJLEtBQUtILE1BQUwsQ0FBWUksTUFBWixHQUFxQixDQUF6QixFQUE0QjtNQUMxQixLQUFLSixNQUFMLElBQWUsSUFBZjtJQUNEOztJQUNELEtBQUtBLE1BQUwsR0FBZSxHQUFFLEtBQUtBLE1BQU8sR0FBRUUsS0FBTSxLQUFJQyxPQUFRLEVBQWpEO0VBQ0Q7O0FBYlc7O0FBZ0JkLFNBQVNFLE9BQVQsQ0FBaUJDLE9BQWpCLEVBQTBCTCxHQUExQixFQUErQkYsSUFBSSxHQUFHLEVBQXRDLEVBQTBDO0VBQ3hDLElBQUlRLE9BQU8sR0FBRyxJQUFJVixPQUFKLENBQVlFLElBQVosQ0FBZDs7RUFDQSxLQUFLLElBQUlTLENBQVQsSUFBY1AsR0FBRyxDQUFDUSxNQUFsQixFQUEwQjtJQUN4QkgsT0FBTyxDQUFDSSxJQUFSLENBQWFULEdBQWIsRUFBa0JPLENBQWxCLEVBQXFCRyxTQUFyQixDQUErQixTQUFTQyxTQUFULENBQW1CQyxJQUFuQixFQUF5QjtNQUN0RE4sT0FBTyxDQUFDTixHQUFSLENBQVlPLENBQVosRUFBZUssSUFBZjtJQUNELENBRkQ7RUFHRDs7RUFDRCxPQUFPTixPQUFQO0FBQ0QifQ==
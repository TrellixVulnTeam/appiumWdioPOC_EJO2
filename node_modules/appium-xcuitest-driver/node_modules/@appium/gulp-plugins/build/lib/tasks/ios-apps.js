'use strict';

require("source-map-support/register");

const path = require('path');

const log = require('fancy-log');

const _ = require('lodash');

const {
  exec
} = require('../utils');

const B = require('bluebird');

const fs = require('fs');

const rimraf = B.promisify(require('rimraf'));
const renameFile = B.promisify(fs.rename, {
  context: fs
});
const MAX_BUFFER_SIZE = 524288;
const REAL_DEVICE_FLAGS = ['IOS_REAL_DEVICE', 'REAL_DEVICE'];

function configure(gulp, opts) {
  if (_.isEmpty(opts.iosApps)) {
    return;
  }

  const relativeLocations = opts.iosApps.relativeLocations;
  const SDKS = {
    iphonesimulator: {
      name: 'iphonesimulator',
      buildPath: path.resolve('build', 'Release-iphonesimulator', opts.iosApps.appName),
      finalPath: relativeLocations.iphonesimulator
    },
    iphoneos: {
      name: 'iphoneos',
      buildPath: path.resolve('build', 'Release-iphoneos', opts.iosApps.appName),
      finalPath: relativeLocations.iphoneos
    }
  };
  let sdks = ['iphonesimulator'];
  let sdkVer;

  async function getIOSSDK() {
    if (!sdkVer) {
      try {
        const {
          stdout
        } = await exec('xcrun', ['--sdk', 'iphonesimulator', '--show-sdk-version']);
        sdkVer = stdout.trim();
      } catch (err) {
        log(`Unable to get max iOS SDK: ${err.message}`);
        throw err;
      }
    }

    return sdkVer;
  }

  function logErrorLines(str = '') {
    str = `${str}`;

    for (const line of str.split('\n')) {
      log.error(`    ${line}`);
    }
  }

  function logError(err, prefix = 'Failed:') {
    log.error(`${prefix}: ${err.message}`);
    log.error('Stdout:');
    logErrorLines(err.stdout);
    log.error('Stderr:');
    logErrorLines(err.stderr);
  }

  async function cleanApp(appRoot, sdk) {
    log(`Cleaning app for ${sdk} at app root '${appRoot}'`);

    try {
      const cmd = 'xcodebuild';
      const args = ['-sdk', sdk, 'clean'];
      log(`    Executing command '${cmd} ${args.join(' ')}'`);
      await exec(cmd, args, {
        cwd: appRoot,
        maxBuffer: MAX_BUFFER_SIZE
      });
    } catch (err) {
      logError(err, 'Failed cleaning app');
      throw err;
    }
  }

  gulp.task('ios-apps:sdks', function findSDKs(done) {
    for (const flag of REAL_DEVICE_FLAGS) {
      const value = process.env[flag];

      if (!_.isEmpty(value) && !!parseInt(value, 10)) {
        log(`Enabling real device build because '${flag}' environment variable set (value is '${value}')`);
        sdks.push('iphoneos');
      }
    }

    log(`SDKs to process: ${sdks.map(sdk => `'${sdk}'`).join(', ')}`);
    done();
  });
  gulp.task('ios-apps:clean', async function cleanAll() {
    log('Cleaning all sdks');
    const sdkVer = await getIOSSDK();

    for (const sdk of sdks) {
      await cleanApp('.', sdk + sdkVer);
    }

    log('Deleting all apps');
    const apps = [SDKS.iphonesimulator.buildPath, SDKS.iphonesimulator.finalPath, SDKS.iphoneos.buildPath, SDKS.iphoneos.finalPath];

    for (const app of apps) {
      log(`    Deleting app '${app}'`);
      await rimraf(app);
    }
  });

  async function buildApp(appRoot, sdk) {
    log(`Building app for ${sdk} at app root '${appRoot}'`);

    try {
      const cmd = 'xcodebuild';
      let args = ['-sdk', sdk];

      if (process.env.XCCONFIG_FILE) {
        args.push('-xcconfig', process.env.XCCONFIG_FILE);
      }

      log(`    Executing command '${cmd} ${args.join(' ')}'`);
      await exec(cmd, args, {
        cwd: appRoot,
        maxBuffer: MAX_BUFFER_SIZE
      });
    } catch (err) {
      logError(err, 'Failed building app');
      throw err;
    }
  }

  gulp.task('ios-apps:build', async function buildAll() {
    log('Building all apps');
    const sdkVer = await getIOSSDK();

    for (const sdk of sdks) {
      await buildApp('.', sdk + sdkVer);
    }
  });
  gulp.task('ios-apps:rename', async function iosAppsRename() {
    log('Renaming apps');

    for (const sdk of sdks) {
      log(`    Renaming for ${sdk}`);
      log(`        '${SDKS[sdk].buildPath}' => '${SDKS[sdk].finalPath}'`);
      await renameFile(SDKS[sdk].buildPath, SDKS[sdk].finalPath);
    }
  });
  gulp.task('ios-apps:install', gulp.series('ios-apps:sdks', 'ios-apps:clean', 'ios-apps:build', 'ios-apps:rename'));
}

module.exports = {
  configure
};require('source-map-support').install();


//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibGliL3Rhc2tzL2lvcy1hcHBzLmpzIiwibmFtZXMiOlsicGF0aCIsInJlcXVpcmUiLCJsb2ciLCJfIiwiZXhlYyIsIkIiLCJmcyIsInJpbXJhZiIsInByb21pc2lmeSIsInJlbmFtZUZpbGUiLCJyZW5hbWUiLCJjb250ZXh0IiwiTUFYX0JVRkZFUl9TSVpFIiwiUkVBTF9ERVZJQ0VfRkxBR1MiLCJjb25maWd1cmUiLCJndWxwIiwib3B0cyIsImlzRW1wdHkiLCJpb3NBcHBzIiwicmVsYXRpdmVMb2NhdGlvbnMiLCJTREtTIiwiaXBob25lc2ltdWxhdG9yIiwibmFtZSIsImJ1aWxkUGF0aCIsInJlc29sdmUiLCJhcHBOYW1lIiwiZmluYWxQYXRoIiwiaXBob25lb3MiLCJzZGtzIiwic2RrVmVyIiwiZ2V0SU9TU0RLIiwic3Rkb3V0IiwidHJpbSIsImVyciIsIm1lc3NhZ2UiLCJsb2dFcnJvckxpbmVzIiwic3RyIiwibGluZSIsInNwbGl0IiwiZXJyb3IiLCJsb2dFcnJvciIsInByZWZpeCIsInN0ZGVyciIsImNsZWFuQXBwIiwiYXBwUm9vdCIsInNkayIsImNtZCIsImFyZ3MiLCJqb2luIiwiY3dkIiwibWF4QnVmZmVyIiwidGFzayIsImZpbmRTREtzIiwiZG9uZSIsImZsYWciLCJ2YWx1ZSIsInByb2Nlc3MiLCJlbnYiLCJwYXJzZUludCIsInB1c2giLCJtYXAiLCJjbGVhbkFsbCIsImFwcHMiLCJhcHAiLCJidWlsZEFwcCIsIlhDQ09ORklHX0ZJTEUiLCJidWlsZEFsbCIsImlvc0FwcHNSZW5hbWUiLCJzZXJpZXMiLCJtb2R1bGUiLCJleHBvcnRzIl0sInNvdXJjZVJvb3QiOiIuLi8uLi8uLiIsInNvdXJjZXMiOlsibGliL3Rhc2tzL2lvcy1hcHBzLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc3RyaWN0JztcblxuY29uc3QgcGF0aCA9IHJlcXVpcmUoJ3BhdGgnKTtcbmNvbnN0IGxvZyA9IHJlcXVpcmUoJ2ZhbmN5LWxvZycpO1xuY29uc3QgXyA9IHJlcXVpcmUoJ2xvZGFzaCcpO1xuY29uc3Qge2V4ZWN9ID0gcmVxdWlyZSgnLi4vdXRpbHMnKTtcbmNvbnN0IEIgPSByZXF1aXJlKCdibHVlYmlyZCcpO1xuY29uc3QgZnMgPSByZXF1aXJlKCdmcycpO1xuY29uc3QgcmltcmFmID0gQi5wcm9taXNpZnkocmVxdWlyZSgncmltcmFmJykpO1xuXG5jb25zdCByZW5hbWVGaWxlID0gQi5wcm9taXNpZnkoZnMucmVuYW1lLCB7Y29udGV4dDogZnN9KTtcblxuY29uc3QgTUFYX0JVRkZFUl9TSVpFID0gNTI0Mjg4O1xuXG5jb25zdCBSRUFMX0RFVklDRV9GTEFHUyA9IFsnSU9TX1JFQUxfREVWSUNFJywgJ1JFQUxfREVWSUNFJ107XG5cbmZ1bmN0aW9uIGNvbmZpZ3VyZShndWxwLCBvcHRzKSB7XG4gIGlmIChfLmlzRW1wdHkob3B0cy5pb3NBcHBzKSkge1xuICAgIC8vIG5vdGhpbmcgdG8gZG9cbiAgICByZXR1cm47XG4gIH1cblxuICAvLyBleHRyYWN0IHRoZSBwYXRocyBmcm9tIHRoZSBlbmNsb3NpbmcgcGFja2FnZSBjb25maWd1cmF0aW9uXG4gIGNvbnN0IHJlbGF0aXZlTG9jYXRpb25zID0gb3B0cy5pb3NBcHBzLnJlbGF0aXZlTG9jYXRpb25zO1xuXG4gIC8vIGZpZ3VyZSBvdXQgd2hlcmUgdGhpbmdzIHdpbGwgZ28gaW4gdGhlIGVuZFxuICBjb25zdCBTREtTID0ge1xuICAgIGlwaG9uZXNpbXVsYXRvcjoge1xuICAgICAgbmFtZTogJ2lwaG9uZXNpbXVsYXRvcicsXG4gICAgICBidWlsZFBhdGg6IHBhdGgucmVzb2x2ZSgnYnVpbGQnLCAnUmVsZWFzZS1pcGhvbmVzaW11bGF0b3InLCBvcHRzLmlvc0FwcHMuYXBwTmFtZSksXG4gICAgICBmaW5hbFBhdGg6IHJlbGF0aXZlTG9jYXRpb25zLmlwaG9uZXNpbXVsYXRvcixcbiAgICB9LFxuICAgIGlwaG9uZW9zOiB7XG4gICAgICBuYW1lOiAnaXBob25lb3MnLFxuICAgICAgYnVpbGRQYXRoOiBwYXRoLnJlc29sdmUoJ2J1aWxkJywgJ1JlbGVhc2UtaXBob25lb3MnLCBvcHRzLmlvc0FwcHMuYXBwTmFtZSksXG4gICAgICBmaW5hbFBhdGg6IHJlbGF0aXZlTG9jYXRpb25zLmlwaG9uZW9zLFxuICAgIH0sXG4gIH07XG5cbiAgLy8gdGhlIHNka3MgYWdhaW5zdCB3aGljaCB3ZSB3aWxsIGJ1aWxkXG4gIGxldCBzZGtzID0gWydpcGhvbmVzaW11bGF0b3InXTtcblxuICBsZXQgc2RrVmVyO1xuICBhc3luYyBmdW5jdGlvbiBnZXRJT1NTREsoKSB7XG4gICAgaWYgKCFzZGtWZXIpIHtcbiAgICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IHtzdGRvdXR9ID0gYXdhaXQgZXhlYygneGNydW4nLCBbJy0tc2RrJywgJ2lwaG9uZXNpbXVsYXRvcicsICctLXNob3ctc2RrLXZlcnNpb24nXSk7XG4gICAgICAgIHNka1ZlciA9IHN0ZG91dC50cmltKCk7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgcmVxdWlyZS1hdG9taWMtdXBkYXRlc1xuICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgIGxvZyhgVW5hYmxlIHRvIGdldCBtYXggaU9TIFNESzogJHtlcnIubWVzc2FnZX1gKTtcbiAgICAgICAgdGhyb3cgZXJyO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gc2RrVmVyO1xuICB9XG5cbiAgZnVuY3Rpb24gbG9nRXJyb3JMaW5lcyhzdHIgPSAnJykge1xuICAgIHN0ciA9IGAke3N0cn1gO1xuICAgIGZvciAoY29uc3QgbGluZSBvZiBzdHIuc3BsaXQoJ1xcbicpKSB7XG4gICAgICBsb2cuZXJyb3IoYCAgICAke2xpbmV9YCk7XG4gICAgfVxuICB9XG5cbiAgZnVuY3Rpb24gbG9nRXJyb3IoZXJyLCBwcmVmaXggPSAnRmFpbGVkOicpIHtcbiAgICBsb2cuZXJyb3IoYCR7cHJlZml4fTogJHtlcnIubWVzc2FnZX1gKTtcbiAgICBsb2cuZXJyb3IoJ1N0ZG91dDonKTtcbiAgICBsb2dFcnJvckxpbmVzKGVyci5zdGRvdXQpO1xuICAgIGxvZy5lcnJvcignU3RkZXJyOicpO1xuICAgIGxvZ0Vycm9yTGluZXMoZXJyLnN0ZGVycik7XG4gIH1cblxuICBhc3luYyBmdW5jdGlvbiBjbGVhbkFwcChhcHBSb290LCBzZGspIHtcbiAgICBsb2coYENsZWFuaW5nIGFwcCBmb3IgJHtzZGt9IGF0IGFwcCByb290ICcke2FwcFJvb3R9J2ApO1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBjbWQgPSAneGNvZGVidWlsZCc7XG4gICAgICBjb25zdCBhcmdzID0gWyctc2RrJywgc2RrLCAnY2xlYW4nXTtcbiAgICAgIGxvZyhgICAgIEV4ZWN1dGluZyBjb21tYW5kICcke2NtZH0gJHthcmdzLmpvaW4oJyAnKX0nYCk7XG4gICAgICBhd2FpdCBleGVjKGNtZCwgYXJncywge2N3ZDogYXBwUm9vdCwgbWF4QnVmZmVyOiBNQVhfQlVGRkVSX1NJWkV9KTtcbiAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgIGxvZ0Vycm9yKGVyciwgJ0ZhaWxlZCBjbGVhbmluZyBhcHAnKTtcbiAgICAgIHRocm93IGVycjtcbiAgICB9XG4gIH1cblxuICBndWxwLnRhc2soJ2lvcy1hcHBzOnNka3MnLCBmdW5jdGlvbiBmaW5kU0RLcyhkb25lKSB7XG4gICAgLy8gZGV0ZXJtaW5lIGlmIHRoZSByZWFsIGRldmljZSBzZGsgc2hvdWxkIGJlIHVzZWQsIHRvb1xuICAgIGZvciAoY29uc3QgZmxhZyBvZiBSRUFMX0RFVklDRV9GTEFHUykge1xuICAgICAgY29uc3QgdmFsdWUgPSBwcm9jZXNzLmVudltmbGFnXTtcbiAgICAgIGlmICghXy5pc0VtcHR5KHZhbHVlKSAmJiAhIXBhcnNlSW50KHZhbHVlLCAxMCkpIHtcbiAgICAgICAgbG9nKFxuICAgICAgICAgIGBFbmFibGluZyByZWFsIGRldmljZSBidWlsZCBiZWNhdXNlICcke2ZsYWd9JyBlbnZpcm9ubWVudCB2YXJpYWJsZSBzZXQgKHZhbHVlIGlzICcke3ZhbHVlfScpYFxuICAgICAgICApO1xuICAgICAgICBzZGtzLnB1c2goJ2lwaG9uZW9zJyk7XG4gICAgICB9XG4gICAgfVxuICAgIGxvZyhgU0RLcyB0byBwcm9jZXNzOiAke3Nka3MubWFwKChzZGspID0+IGAnJHtzZGt9J2ApLmpvaW4oJywgJyl9YCk7XG4gICAgZG9uZSgpO1xuICB9KTtcblxuICBndWxwLnRhc2soJ2lvcy1hcHBzOmNsZWFuJywgYXN5bmMgZnVuY3Rpb24gY2xlYW5BbGwoKSB7XG4gICAgbG9nKCdDbGVhbmluZyBhbGwgc2RrcycpO1xuICAgIGNvbnN0IHNka1ZlciA9IGF3YWl0IGdldElPU1NESygpO1xuICAgIGZvciAoY29uc3Qgc2RrIG9mIHNka3MpIHtcbiAgICAgIGF3YWl0IGNsZWFuQXBwKCcuJywgc2RrICsgc2RrVmVyKTtcbiAgICB9XG5cbiAgICBsb2coJ0RlbGV0aW5nIGFsbCBhcHBzJyk7XG4gICAgY29uc3QgYXBwcyA9IFtcbiAgICAgIFNES1MuaXBob25lc2ltdWxhdG9yLmJ1aWxkUGF0aCxcbiAgICAgIFNES1MuaXBob25lc2ltdWxhdG9yLmZpbmFsUGF0aCxcbiAgICAgIFNES1MuaXBob25lb3MuYnVpbGRQYXRoLFxuICAgICAgU0RLUy5pcGhvbmVvcy5maW5hbFBhdGgsXG4gICAgXTtcbiAgICBmb3IgKGNvbnN0IGFwcCBvZiBhcHBzKSB7XG4gICAgICBsb2coYCAgICBEZWxldGluZyBhcHAgJyR7YXBwfSdgKTtcbiAgICAgIGF3YWl0IHJpbXJhZihhcHApO1xuICAgIH1cbiAgfSk7XG5cbiAgYXN5bmMgZnVuY3Rpb24gYnVpbGRBcHAoYXBwUm9vdCwgc2RrKSB7XG4gICAgbG9nKGBCdWlsZGluZyBhcHAgZm9yICR7c2RrfSBhdCBhcHAgcm9vdCAnJHthcHBSb290fSdgKTtcbiAgICB0cnkge1xuICAgICAgY29uc3QgY21kID0gJ3hjb2RlYnVpbGQnO1xuICAgICAgbGV0IGFyZ3MgPSBbJy1zZGsnLCBzZGtdO1xuICAgICAgaWYgKHByb2Nlc3MuZW52LlhDQ09ORklHX0ZJTEUpIHtcbiAgICAgICAgYXJncy5wdXNoKCcteGNjb25maWcnLCBwcm9jZXNzLmVudi5YQ0NPTkZJR19GSUxFKTtcbiAgICAgIH1cblxuICAgICAgbG9nKGAgICAgRXhlY3V0aW5nIGNvbW1hbmQgJyR7Y21kfSAke2FyZ3Muam9pbignICcpfSdgKTtcbiAgICAgIGF3YWl0IGV4ZWMoY21kLCBhcmdzLCB7Y3dkOiBhcHBSb290LCBtYXhCdWZmZXI6IE1BWF9CVUZGRVJfU0laRX0pO1xuICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgbG9nRXJyb3IoZXJyLCAnRmFpbGVkIGJ1aWxkaW5nIGFwcCcpO1xuICAgICAgdGhyb3cgZXJyO1xuICAgIH1cbiAgfVxuXG4gIGd1bHAudGFzaygnaW9zLWFwcHM6YnVpbGQnLCBhc3luYyBmdW5jdGlvbiBidWlsZEFsbCgpIHtcbiAgICBsb2coJ0J1aWxkaW5nIGFsbCBhcHBzJyk7XG4gICAgY29uc3Qgc2RrVmVyID0gYXdhaXQgZ2V0SU9TU0RLKCk7XG4gICAgZm9yIChjb25zdCBzZGsgb2Ygc2Rrcykge1xuICAgICAgYXdhaXQgYnVpbGRBcHAoJy4nLCBzZGsgKyBzZGtWZXIpO1xuICAgIH1cbiAgfSk7XG5cbiAgZ3VscC50YXNrKCdpb3MtYXBwczpyZW5hbWUnLCBhc3luYyBmdW5jdGlvbiBpb3NBcHBzUmVuYW1lKCkge1xuICAgIGxvZygnUmVuYW1pbmcgYXBwcycpO1xuICAgIGZvciAoY29uc3Qgc2RrIG9mIHNka3MpIHtcbiAgICAgIGxvZyhgICAgIFJlbmFtaW5nIGZvciAke3Nka31gKTtcbiAgICAgIGxvZyhgICAgICAgICAnJHtTREtTW3Nka10uYnVpbGRQYXRofScgPT4gJyR7U0RLU1tzZGtdLmZpbmFsUGF0aH0nYCk7XG4gICAgICBhd2FpdCByZW5hbWVGaWxlKFNES1Nbc2RrXS5idWlsZFBhdGgsIFNES1Nbc2RrXS5maW5hbFBhdGgpO1xuICAgIH1cbiAgfSk7XG5cbiAgZ3VscC50YXNrKFxuICAgICdpb3MtYXBwczppbnN0YWxsJyxcbiAgICBndWxwLnNlcmllcygnaW9zLWFwcHM6c2RrcycsICdpb3MtYXBwczpjbGVhbicsICdpb3MtYXBwczpidWlsZCcsICdpb3MtYXBwczpyZW5hbWUnKVxuICApO1xufVxuXG5tb2R1bGUuZXhwb3J0cyA9IHtcbiAgY29uZmlndXJlLFxufTtcbiJdLCJtYXBwaW5ncyI6IkFBQUE7Ozs7QUFFQSxNQUFNQSxJQUFJLEdBQUdDLE9BQU8sQ0FBQyxNQUFELENBQXBCOztBQUNBLE1BQU1DLEdBQUcsR0FBR0QsT0FBTyxDQUFDLFdBQUQsQ0FBbkI7O0FBQ0EsTUFBTUUsQ0FBQyxHQUFHRixPQUFPLENBQUMsUUFBRCxDQUFqQjs7QUFDQSxNQUFNO0VBQUNHO0FBQUQsSUFBU0gsT0FBTyxDQUFDLFVBQUQsQ0FBdEI7O0FBQ0EsTUFBTUksQ0FBQyxHQUFHSixPQUFPLENBQUMsVUFBRCxDQUFqQjs7QUFDQSxNQUFNSyxFQUFFLEdBQUdMLE9BQU8sQ0FBQyxJQUFELENBQWxCOztBQUNBLE1BQU1NLE1BQU0sR0FBR0YsQ0FBQyxDQUFDRyxTQUFGLENBQVlQLE9BQU8sQ0FBQyxRQUFELENBQW5CLENBQWY7QUFFQSxNQUFNUSxVQUFVLEdBQUdKLENBQUMsQ0FBQ0csU0FBRixDQUFZRixFQUFFLENBQUNJLE1BQWYsRUFBdUI7RUFBQ0MsT0FBTyxFQUFFTDtBQUFWLENBQXZCLENBQW5CO0FBRUEsTUFBTU0sZUFBZSxHQUFHLE1BQXhCO0FBRUEsTUFBTUMsaUJBQWlCLEdBQUcsQ0FBQyxpQkFBRCxFQUFvQixhQUFwQixDQUExQjs7QUFFQSxTQUFTQyxTQUFULENBQW1CQyxJQUFuQixFQUF5QkMsSUFBekIsRUFBK0I7RUFDN0IsSUFBSWIsQ0FBQyxDQUFDYyxPQUFGLENBQVVELElBQUksQ0FBQ0UsT0FBZixDQUFKLEVBQTZCO0lBRTNCO0VBQ0Q7O0VBR0QsTUFBTUMsaUJBQWlCLEdBQUdILElBQUksQ0FBQ0UsT0FBTCxDQUFhQyxpQkFBdkM7RUFHQSxNQUFNQyxJQUFJLEdBQUc7SUFDWEMsZUFBZSxFQUFFO01BQ2ZDLElBQUksRUFBRSxpQkFEUztNQUVmQyxTQUFTLEVBQUV2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

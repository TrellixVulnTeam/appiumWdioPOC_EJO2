'use strict';

require("source-map-support/register");

const Transpiler = require('../../index').Transpiler;

const debug = require('gulp-debug');

const gulpIf = require('gulp-if');

const merge = require('merge-stream');

const {
  isVerbose
} = require('../utils');

const JSON_SOURCES = ['lib/**/*.json', 'test/**/*.json'];

const configure = function configure(gulp, opts, env) {
  const tasks = [function transpileSources() {
    const firstPath = gulp.src(JSON_SOURCES, {
      base: './'
    }).pipe(gulp.dest(opts.transpileOut));
    const secondPath = gulp.src(opts.files, {
      base: './'
    }).pipe(gulpIf(isVerbose(), debug())).pipe(new Transpiler(opts).stream()).on('error', env.spawnWatcher.handleError.bind(env.spawnWatcher)).pipe(gulp.dest(opts.transpileOut));
    return merge(firstPath, secondPath);
  }];

  if (opts.postTranspile && opts.postTranspile.length) {
    gulp.task('post-transpile', gulp.parallel(opts.postTranspile));
    tasks.push('post-transpile');
  }

  gulp.task('transpile', gulp.series(tasks));
};

module.exports = {
  configure
};require('source-map-support').install();


//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibGliL3Rhc2tzL3RyYW5zcGlsZS5qcyIsIm5hbWVzIjpbIlRyYW5zcGlsZXIiLCJyZXF1aXJlIiwiZGVidWciLCJndWxwSWYiLCJtZXJnZSIsImlzVmVyYm9zZSIsIkpTT05fU09VUkNFUyIsImNvbmZpZ3VyZSIsImd1bHAiLCJvcHRzIiwiZW52IiwidGFza3MiLCJ0cmFuc3BpbGVTb3VyY2VzIiwiZmlyc3RQYXRoIiwic3JjIiwiYmFzZSIsInBpcGUiLCJkZXN0IiwidHJhbnNwaWxlT3V0Iiwic2Vjb25kUGF0aCIsImZpbGVzIiwic3RyZWFtIiwib24iLCJzcGF3bldhdGNoZXIiLCJoYW5kbGVFcnJvciIsImJpbmQiLCJwb3N0VHJhbnNwaWxlIiwibGVuZ3RoIiwidGFzayIsInBhcmFsbGVsIiwicHVzaCIsInNlcmllcyIsIm1vZHVsZSIsImV4cG9ydHMiXSwic291cmNlUm9vdCI6Ii4uLy4uLy4uIiwic291cmNlcyI6WyJsaWIvdGFza3MvdHJhbnNwaWxlLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc3RyaWN0JztcblxuY29uc3QgVHJhbnNwaWxlciA9IHJlcXVpcmUoJy4uLy4uL2luZGV4JykuVHJhbnNwaWxlcjtcbmNvbnN0IGRlYnVnID0gcmVxdWlyZSgnZ3VscC1kZWJ1ZycpO1xuY29uc3QgZ3VscElmID0gcmVxdWlyZSgnZ3VscC1pZicpO1xuY29uc3QgbWVyZ2UgPSByZXF1aXJlKCdtZXJnZS1zdHJlYW0nKTtcbmNvbnN0IHtpc1ZlcmJvc2V9ID0gcmVxdWlyZSgnLi4vdXRpbHMnKTtcblxuY29uc3QgSlNPTl9TT1VSQ0VTID0gWydsaWIvKiovKi5qc29uJywgJ3Rlc3QvKiovKi5qc29uJ107XG5cbi8qKlxuICogQHBhcmFtIHtpbXBvcnQoJ2d1bHAnKS5HdWxwfSBndWxwIC0gVGhlIGd1bHAgaW5zdGFuY2UuXG4gKi9cbmNvbnN0IGNvbmZpZ3VyZSA9IGZ1bmN0aW9uIGNvbmZpZ3VyZShndWxwLCBvcHRzLCBlbnYpIHtcbiAgY29uc3QgdGFza3MgPSBbXG4gICAgZnVuY3Rpb24gdHJhbnNwaWxlU291cmNlcygpIHtcbiAgICAgIC8vIGpzb24gZmlsZXMgY2FuIGJlIGNvcGllZCBhcyBpcywgdGhleSBkb24ndCBuZWVkIHRvIGJlIHRyYW5zcGlsZWRcbiAgICAgIGNvbnN0IGZpcnN0UGF0aCA9IGd1bHAuc3JjKEpTT05fU09VUkNFUywge2Jhc2U6ICcuLyd9KS5waXBlKGd1bHAuZGVzdChvcHRzLnRyYW5zcGlsZU91dCkpO1xuICAgICAgY29uc3Qgc2Vjb25kUGF0aCA9IGd1bHBcbiAgICAgICAgLnNyYyhvcHRzLmZpbGVzLCB7YmFzZTogJy4vJ30pXG4gICAgICAgIC5waXBlKGd1bHBJZihpc1ZlcmJvc2UoKSwgZGVidWcoKSkpXG4gICAgICAgIC5waXBlKG5ldyBUcmFuc3BpbGVyKG9wdHMpLnN0cmVhbSgpKVxuICAgICAgICAub24oJ2Vycm9yJywgZW52LnNwYXduV2F0Y2hlci5oYW5kbGVFcnJvci5iaW5kKGVudi5zcGF3bldhdGNoZXIpKVxuICAgICAgICAucGlwZShndWxwLmRlc3Qob3B0cy50cmFuc3BpbGVPdXQpKTtcbiAgICAgIHJldHVybiBtZXJnZShmaXJzdFBhdGgsIHNlY29uZFBhdGgpO1xuICAgIH0sXG4gIF07XG5cbiAgaWYgKG9wdHMucG9zdFRyYW5zcGlsZSAmJiBvcHRzLnBvc3RUcmFuc3BpbGUubGVuZ3RoKSB7XG4gICAgZ3VscC50YXNrKCdwb3N0LXRyYW5zcGlsZScsIGd1bHAucGFyYWxsZWwob3B0cy5wb3N0VHJhbnNwaWxlKSk7XG4gICAgdGFza3MucHVzaCgncG9zdC10cmFuc3BpbGUnKTtcbiAgfVxuXG4gIGd1bHAudGFzaygndHJhbnNwaWxlJywgZ3VscC5zZXJpZXModGFza3MpKTtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0ge1xuICBjb25maWd1cmUsXG59O1xuIl0sIm1hcHBpbmdzIjoiQUFBQTs7OztBQUVBLE1BQU1BLFVBQVUsR0FBR0MsT0FBTyxDQUFDLGFBQUQsQ0FBUCxDQUF1QkQsVUFBMUM7O0FBQ0EsTUFBTUUsS0FBSyxHQUFHRCxPQUFPLENBQUMsWUFBRCxDQUFyQjs7QUFDQSxNQUFNRSxNQUFNLEdBQUdGLE9BQU8sQ0FBQyxTQUFELENBQXRCOztBQUNBLE1BQU1HLEtBQUssR0FBR0gsT0FBTyxDQUFDLGNBQUQsQ0FBckI7O0FBQ0EsTUFBTTtFQUFDSTtBQUFELElBQWNKLE9BQU8sQ0FBQyxVQUFELENBQTNCOztBQUVBLE1BQU1LLFlBQVksR0FBRyxDQUFDLGVBQUQsRUFBa0IsZ0JBQWxCLENBQXJCOztBQUtBLE1BQU1DLFNBQVMsR0FBRyxTQUFTQSxTQUFULENBQW1CQyxJQUFuQixFQUF5QkMsSUFBekIsRUFBK0JDLEdBQS9CLEVBQW9DO0VBQ3BELE1BQU1DLEtBQUssR0FBRyxDQUNaLFNBQVNDLGdCQUFULEdBQTRCO0lBRTFCLE1BQU1DLFNBQVMsR0FBR0wsSUFBSSxDQUFDTSxHQUFMLENBQVNSLFlBQVQsRUFBdUI7TUFBQ1MsSUFBSSxFQUFFO0lBQVAsQ0FBdkIsRUFBcUNDLElBQXJDLENBQTBDUixJQUFJLENBQUNTLElBQUwsQ0FBVVIsSUFBSSxDQUFDUyxZQUFmLENBQTFDLENBQWxCO0lBQ0EsTUFBTUMsVUFBVSxHQUFHWCxJQUFJLENBQ3BCTSxHQURnQixDQUNaTCxJQUFJLENBQUNXLEtBRE8sRUFDQTtNQUFDTCxJQUFJLEVBQUU7SUFBUCxDQURBLEVBRWhCQyxJQUZnQixDQUVYYixNQUFNLENBQUNFLFNBQVMsRUFBVixFQUFjSCxLQUFLLEVBQW5CLENBRkssRUFHaEJjLElBSGdCLENBR1gsSUFBSWhCLFVBQUosQ0FBZVMsSUFBZixFQUFxQlksTUFBckIsRUFIVyxFQUloQkMsRUFKZ0IsQ0FJYixPQUphLEVBSUpaLEdBQUcsQ0FBQ2EsWUFBSixDQUFpQkMsV0FBakIsQ0FBNkJDLElBQTdCLENBQWtDZixHQUFHLENBQUNhLFlBQXRDLENBSkksRUFLaEJQLElBTGdCLENBS1hSLElBQUksQ0FBQ1MsSUFBTCxDQUFVUixJQUFJLENBQUNTLFlBQWYsQ0FMVyxDQUFuQjtJQU1BLE9BQU9kLEtBQUssQ0FBQ1MsU0FBRCxFQUFZTSxVQUFaLENBQVo7RUFDRCxDQVhXLENBQWQ7O0VBY0EsSUFBSVYsSUFBSSxDQUFDaUIsYUFBTCxJQUFzQmpCLElBQUksQ0FBQ2lCLGFBQUwsQ0FBbUJDLE1BQTdDLEVBQXFEO0lBQ25EbkIsSUFBSSxDQUFDb0IsSUFBTCxDQUFVLGdCQUFWLEVBQTRCcEIsSUFBSSxDQUFDcUIsUUFBTCxDQUFjcEIsSUFBSSxDQUFDaUIsYUFBbkIsQ0FBNUI7SUFDQWYsS0FBSyxDQUFDbUIsSUFBTixDQUFXLGdCQUFYO0VBQ0Q7O0VBRUR0QixJQUFJLENBQUNvQixJQUFMLENBQVUsV0FBVixFQUF1QnBCLElBQUksQ0FBQ3VCLE1BQUwsQ0FBWXBCLEtBQVosQ0FBdkI7QUFDRCxDQXJCRDs7QUF1QkFxQixNQUFNLENBQUNDLE9BQVAsR0FBaUI7RUFDZjFCO0FBRGUsQ0FBakIifQ==

"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

require("source-map-support/register");

var _path = _interopRequireDefault(require("path"));

var _url = _interopRequireDefault(require("url"));

var _support = require("@appium/support");

var _helpers = require("../../../lib/basedriver/helpers");

var _http = _interopRequireDefault(require("http"));

var _finalhandler = _interopRequireDefault(require("finalhandler"));

var _serveStatic = _interopRequireDefault(require("serve-static"));

var _contentDisposition = _interopRequireDefault(require("content-disposition"));

var _bluebird = _interopRequireDefault(require("bluebird"));

var _helpers2 = require("../../helpers");

function getFixture(file) {
  return _path.default.resolve(__dirname, '..', 'fixtures', file);
}

describe('app download and configuration', function () {
  describe('configureApp', function () {
    it('should get the path for a local .app', async function () {
      let newAppPath = await (0, _helpers.configureApp)(getFixture('FakeIOSApp.app'), '.app');
      newAppPath.should.contain('FakeIOSApp.app');
      let contents = await _support.fs.readFile(newAppPath, 'utf8');
      contents.should.eql('this is not really an app\n');
    });
    it('should get the path for a local .apk', async function () {
      let newAppPath = await (0, _helpers.configureApp)(getFixture('FakeAndroidApp.apk'), '.apk');
      newAppPath.should.contain('FakeAndroidApp.apk');
      let contents = await _support.fs.readFile(newAppPath, 'utf8');
      contents.should.eql('this is not really an apk\n');
    });
    it('should unzip and get the path for a local .app.zip', async function () {
      let newAppPath = await (0, _helpers.configureApp)(getFixture('FakeIOSApp.app.zip'), '.app');
      newAppPath.should.contain('FakeIOSApp.app');
      let contents = await _support.fs.readFile(newAppPath, 'utf8');
      contents.should.eql('this is not really an app\n');
    });
    it('should unzip and get the path for a local .ipa', async function () {
      let newAppPath = await (0, _helpers.configureApp)(getFixture('FakeIOSApp.ipa'), '.app');
      newAppPath.should.contain('FakeIOSApp.app');
      let contents = await _support.fs.readFile(newAppPath, 'utf8');
      contents.should.eql('this is not really an app\n');
    });
    it('should fail for a bad zip file', async function () {
      await (0, _helpers.configureApp)(getFixture('BadZippedApp.zip'), '.app').should.be.rejectedWith(/PK/);
    });
    it('should fail if extensions do not match', async function () {
      await (0, _helpers.configureApp)(getFixture('FakeIOSApp.app'), '.wrong').should.be.rejectedWith(/did not have extension/);
    });
    it('should fail if zip file does not contain an app whose extension matches', async function () {
      await (0, _helpers.configureApp)(getFixture('FakeIOSApp.app.zip'), '.wrong').should.be.rejectedWith(/did not have extension/);
    });
    describe('should download an app from the web', function () {
      let port;
      let serverUrl;
      before(async function () {
        port = await (0, _helpers2.getTestPort)(true);
        serverUrl = `http://${_helpers2.TEST_HOST}:${port}`;
      });
      describe('server not available', function () {
        it('should handle server not available', async function () {
          await (0, _helpers.configureApp)(`${serverUrl}/FakeIOSApp.app.zip`, '.app').should.eventually.be.rejectedWith(/ECONNREFUSED/);
        });
      });
      describe('server available', function () {
        let server;
        before(function () {
          const dir = _path.default.resolve(__dirname, '..', 'fixtures');

          const serve = (0, _serveStatic.default)(dir, {
            index: false,
            setHeaders: (res, path) => {
              res.setHeader('Content-Disposition', (0, _contentDisposition.default)(path));
            }
          });
          server = _http.default.createServer(function (req, res) {
            if (req.url.indexOf('missing') !== -1) {
              res.writeHead(404);
              res.end();
              return;
            }

            const contentType = new URLSearchParams(_url.default.parse(req.url).search).get('content-type');

            if (contentType !== null) {
              res.setHeader('content-type', contentType);
            }

            serve(req, res, (0, _finalhandler.default)(req, res));
          });
          const close = server.close.bind(server);

          server.close = async function () {
            await _bluebird.default.delay(1000);
            return await new _bluebird.default((resolve, reject) => {
              server.on('close', resolve);
              close(err => {
                if (err) reject(err);
              });
            });
          };

          server.listen(port);
        });
        after(async function () {
          await server.close();
        });
        it('should download zip file', async function () {
          let newAppPath = await (0, _helpers.configureApp)(`${serverUrl}/FakeIOSApp.app.zip`, '.app');
          newAppPath.should.contain('FakeIOSApp.app');
          let contents = await _support.fs.readFile(newAppPath, 'utf8');
          contents.should.eql('this is not really an app\n');
        });
        it('should download zip file with query string', async function () {
          let newAppPath = await (0, _helpers.configureApp)(`${serverUrl}/FakeIOSApp.app.zip?sv=abc&sr=def`, '.app');
          newAppPath.should.contain('.app');
          let contents = await _support.fs.readFile(newAppPath, 'utf8');
          contents.should.eql('this is not really an app\n');
        });
        it('should download an app file', async function () {
          let newAppPath = await (0, _helpers.configureApp)(`${serverUrl}/FakeIOSApp.app`, '.app');
          newAppPath.should.contain('.app');
          let contents = await _support.fs.readFile(newAppPath, 'utf8');
          contents.should.eql('this is not really an app\n');
        });
        it('should accept multiple extensions', async function () {
          let newAppPath = await (0, _helpers.configureApp)(`${serverUrl}/FakeIOSApp.app.zip`, ['.app', '.aab']);
          newAppPath.should.contain('FakeIOSApp.app');
          let contents = await _support.fs.readFile(newAppPath, 'utf8');
          contents.should.eql('this is not really an app\n');
        });
        it('should download an apk file', async function () {
          let newAppPath = await (0, _helpers.configureApp)(`${serverUrl}/FakeAndroidApp.apk`, '.apk');
          newAppPath.should.contain('.apk');
          let contents = await _support.fs.readFile(newAppPath, 'utf8');
          contents.should.eql('this is not really an apk\n');
        });
        it('should handle zip file that cannot be downloaded', async function () {
          await (0, _helpers.configureApp)(`${serverUrl}/missing/FakeIOSApp.app.zip`, '.app').should.eventually.be.rejected;
        });
        it('should handle invalid protocol', async function () {
          await (0, _helpers.configureApp)('file://C:/missing/FakeIOSApp.app.zip', '.app').should.eventually.be.rejectedWith(/is not supported/);
          await (0, _helpers.configureApp)(`ftp://${_helpers2.TEST_HOST}:${port}/missing/FakeIOSApp.app.zip`, '.app').should.eventually.be.rejectedWith(/is not supported/);
        });
        it('should handle missing file in Windows path format', async function () {
          await (0, _helpers.configureApp)('C:\\missing\\FakeIOSApp.app.zip', '.app').should.eventually.be.rejectedWith(/does not exist or is not accessible/);
        });
        it('should recognize zip mime types and unzip the downloaded file', async function () {
          let newAppPath = await (0, _helpers.configureApp)(`${serverUrl}/FakeAndroidApp.asd?content-type=${encodeURIComponent('application/zip')}`, '.apk');
          newAppPath.should.contain('FakeAndroidApp.apk');
          newAppPath.should.not.contain('.asd');
          let contents = await _support.fs.readFile(newAppPath, 'utf8');
          contents.should.eql('this is not really an apk\n');
        });
        it('should recognize zip mime types with parameter and unzip the downloaded file', async function () {
          let newAppPath = await (0, _helpers.configureApp)(`${serverUrl}/FakeAndroidApp.asd?content-type=${encodeURIComponent('application/zip; parameter=value')}`, '.apk');
          newAppPath.should.contain('FakeAndroidApp.apk');
          newAppPath.should.not.contain('.asd');
          let contents = await _support.fs.readFile(newAppPath, 'utf8');
          contents.should.eql('this is not really an apk\n');
        });
        it('should recognize zip mime types and unzip the downloaded file with query string', async function () {
          let newAppPath = await (0, _helpers.configureApp)(`${serverUrl}/FakeAndroidApp.asd?content-type=${encodeURIComponent('application/zip')}&sv=abc&sr=def`, '.apk');
          newAppPath.should.contain('FakeAndroidApp.apk');
          newAppPath.should.not.contain('.asd');
          let contents = await _support.fs.readFile(newAppPath, 'utf8');
          contents.should.eql('this is not really an apk\n');
        });
        it('should treat an unknown mime type as an app', async function () {
          let newAppPath = await (0, _helpers.configureApp)(`${serverUrl}/FakeAndroidApp.apk?content-type=${encodeURIComponent('application/bip')}`, '.apk');
          newAppPath.should.contain('.apk');
          let contents = await _support.fs.readFile(newAppPath, 'utf8');
          contents.should.eql('this is not really an apk\n');
        });
      });
    });
  });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJnZXRGaXh0dXJlIiwiZmlsZSIsInBhdGgiLCJyZXNvbHZlIiwiX19kaXJuYW1lIiwiZGVzY3JpYmUiLCJpdCIsIm5ld0FwcFBhdGgiLCJjb25maWd1cmVBcHAiLCJzaG91bGQiLCJjb250YWluIiwiY29udGVudHMiLCJmcyIsInJlYWRGaWxlIiwiZXFsIiwiYmUiLCJyZWplY3RlZFdpdGgiLCJwb3J0Iiwic2VydmVyVXJsIiwiYmVmb3JlIiwiZ2V0VGVzdFBvcnQiLCJURVNUX0hPU1QiLCJldmVudHVhbGx5Iiwic2VydmVyIiwiZGlyIiwic2VydmUiLCJzZXJ2ZVN0YXRpYyIsImluZGV4Iiwic2V0SGVhZGVycyIsInJlcyIsInNldEhlYWRlciIsImNvbnRlbnREaXNwb3NpdGlvbiIsImh0dHAiLCJjcmVhdGVTZXJ2ZXIiLCJyZXEiLCJ1cmwiLCJpbmRleE9mIiwid3JpdGVIZWFkIiwiZW5kIiwiY29udGVudFR5cGUiLCJVUkxTZWFyY2hQYXJhbXMiLCJwYXJzZSIsInNlYXJjaCIsImdldCIsImZpbmFsaGFuZGxlciIsImNsb3NlIiwiYmluZCIsIkIiLCJkZWxheSIsInJlamVjdCIsIm9uIiwiZXJyIiwibGlzdGVuIiwiYWZ0ZXIiLCJyZWplY3RlZCIsImVuY29kZVVSSUNvbXBvbmVudCIsIm5vdCJdLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3Rlc3QvZTJlL2Jhc2Vkcml2ZXIvaGVscGVycy5lMmUuc3BlYy5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgcGF0aCBmcm9tICdwYXRoJztcbmltcG9ydCB1cmwgZnJvbSAndXJsJztcbmltcG9ydCB7ZnN9IGZyb20gJ0BhcHBpdW0vc3VwcG9ydCc7XG5pbXBvcnQge2NvbmZpZ3VyZUFwcH0gZnJvbSAnLi4vLi4vLi4vbGliL2Jhc2Vkcml2ZXIvaGVscGVycyc7XG5pbXBvcnQgaHR0cCBmcm9tICdodHRwJztcbmltcG9ydCBmaW5hbGhhbmRsZXIgZnJvbSAnZmluYWxoYW5kbGVyJztcbmltcG9ydCBzZXJ2ZVN0YXRpYyBmcm9tICdzZXJ2ZS1zdGF0aWMnO1xuaW1wb3J0IGNvbnRlbnREaXNwb3NpdGlvbiBmcm9tICdjb250ZW50LWRpc3Bvc2l0aW9uJztcbmltcG9ydCBCIGZyb20gJ2JsdWViaXJkJztcbmltcG9ydCB7VEVTVF9IT1NULCBnZXRUZXN0UG9ydH0gZnJvbSAnLi4vLi4vaGVscGVycyc7XG5cbmZ1bmN0aW9uIGdldEZpeHR1cmUoZmlsZSkge1xuICAvLyBYWFg6IF9fZGlybmFtZSBkaXNhbGxvd2VkIGluIG5hdGl2ZSBFU01cbiAgcmV0dXJuIHBhdGgucmVzb2x2ZShfX2Rpcm5hbWUsICcuLicsICdmaXh0dXJlcycsIGZpbGUpO1xufVxuXG5kZXNjcmliZSgnYXBwIGRvd25sb2FkIGFuZCBjb25maWd1cmF0aW9uJywgZnVuY3Rpb24gKCkge1xuICBkZXNjcmliZSgnY29uZmlndXJlQXBwJywgZnVuY3Rpb24gKCkge1xuICAgIGl0KCdzaG91bGQgZ2V0IHRoZSBwYXRoIGZvciBhIGxvY2FsIC5hcHAnLCBhc3luYyBmdW5jdGlvbiAoKSB7XG4gICAgICBsZXQgbmV3QXBwUGF0aCA9IGF3YWl0IGNvbmZpZ3VyZUFwcChnZXRGaXh0dXJlKCdGYWtlSU9TQXBwLmFwcCcpLCAnLmFwcCcpO1xuICAgICAgbmV3QXBwUGF0aC5zaG91bGQuY29udGFpbignRmFrZUlPU0FwcC5hcHAnKTtcbiAgICAgIGxldCBjb250ZW50cyA9IGF3YWl0IGZzLnJlYWRGaWxlKG5ld0FwcFBhdGgsICd1dGY4Jyk7XG4gICAgICBjb250ZW50cy5zaG91bGQuZXFsKCd0aGlzIGlzIG5vdCByZWFsbHkgYW4gYXBwXFxuJyk7XG4gICAgfSk7XG4gICAgaXQoJ3Nob3VsZCBnZXQgdGhlIHBhdGggZm9yIGEgbG9jYWwgLmFwaycsIGFzeW5jIGZ1bmN0aW9uICgpIHtcbiAgICAgIGxldCBuZXdBcHBQYXRoID0gYXdhaXQgY29uZmlndXJlQXBwKGdldEZpeHR1cmUoJ0Zha2VBbmRyb2lkQXBwLmFwaycpLCAnLmFwaycpO1xuICAgICAgbmV3QXBwUGF0aC5zaG91bGQuY29udGFpbignRmFrZUFuZHJvaWRBcHAuYXBrJyk7XG4gICAgICBsZXQgY29udGVudHMgPSBhd2FpdCBmcy5yZWFkRmlsZShuZXdBcHBQYXRoLCAndXRmOCcpO1xuICAgICAgY29udGVudHMuc2hvdWxkLmVxbCgndGhpcyBpcyBub3QgcmVhbGx5IGFuIGFwa1xcbicpO1xuICAgIH0pO1xuICAgIGl0KCdzaG91bGQgdW56aXAgYW5kIGdldCB0aGUgcGF0aCBmb3IgYSBsb2NhbCAuYXBwLnppcCcsIGFzeW5jIGZ1bmN0aW9uICgpIHtcbiAgICAgIGxldCBuZXdBcHBQYXRoID0gYXdhaXQgY29uZmlndXJlQXBwKGdldEZpeHR1cmUoJ0Zha2VJT1NBcHAuYXBwLnppcCcpLCAnLmFwcCcpO1xuICAgICAgbmV3QXBwUGF0aC5zaG91bGQuY29udGFpbignRmFrZUlPU0FwcC5hcHAnKTtcbiAgICAgIGxldCBjb250ZW50cyA9IGF3YWl0IGZzLnJlYWRGaWxlKG5ld0FwcFBhdGgsICd1dGY4Jyk7XG4gICAgICBjb250ZW50cy5zaG91bGQuZXFsKCd0aGlzIGlzIG5vdCByZWFsbHkgYW4gYXBwXFxuJyk7XG4gICAgfSk7XG4gICAgaXQoJ3Nob3VsZCB1bnppcCBhbmQgZ2V0IHRoZSBwYXRoIGZvciBhIGxvY2FsIC5pcGEnLCBhc3luYyBmdW5jdGlvbiAoKSB7XG4gICAgICBsZXQgbmV3QXBwUGF0aCA9IGF3YWl0IGNvbmZpZ3VyZUFwcChnZXRGaXh0dXJlKCdGYWtlSU9TQXBwLmlwYScpLCAnLmFwcCcpO1xuICAgICAgbmV3QXBwUGF0aC5zaG91bGQuY29udGFpbignRmFrZUlPU0FwcC5hcHAnKTtcbiAgICAgIGxldCBjb250ZW50cyA9IGF3YWl0IGZzLnJlYWRGaWxlKG5ld0FwcFBhdGgsICd1dGY4Jyk7XG4gICAgICBjb250ZW50cy5zaG91bGQuZXFsKCd0aGlzIGlzIG5vdCByZWFsbHkgYW4gYXBwXFxuJyk7XG4gICAgfSk7XG4gICAgaXQoJ3Nob3VsZCBmYWlsIGZvciBhIGJhZCB6aXAgZmlsZScsIGFzeW5jIGZ1bmN0aW9uICgpIHtcbiAgICAgIGF3YWl0IGNvbmZpZ3VyZUFwcChnZXRGaXh0dXJlKCdCYWRaaXBwZWRBcHAuemlwJyksICcuYXBwJykuc2hvdWxkLmJlLnJlamVjdGVkV2l0aCgvUEsvKTtcbiAgICB9KTtcbiAgICBpdCgnc2hvdWxkIGZhaWwgaWYgZXh0ZW5zaW9ucyBkbyBub3QgbWF0Y2gnLCBhc3luYyBmdW5jdGlvbiAoKSB7XG4gICAgICBhd2FpdCBjb25maWd1cmVBcHAoZ2V0Rml4dHVyZSgnRmFrZUlPU0FwcC5hcHAnKSwgJy53cm9uZycpLnNob3VsZC5iZS5yZWplY3RlZFdpdGgoXG4gICAgICAgIC9kaWQgbm90IGhhdmUgZXh0ZW5zaW9uL1xuICAgICAgKTtcbiAgICB9KTtcbiAgICBpdCgnc2hvdWxkIGZhaWwgaWYgemlwIGZpbGUgZG9lcyBub3QgY29udGFpbiBhbiBhcHAgd2hvc2UgZXh0ZW5zaW9uIG1hdGNoZXMnLCBhc3luYyBmdW5jdGlvbiAoKSB7XG4gICAgICBhd2FpdCBjb25maWd1cmVBcHAoZ2V0Rml4dHVyZSgnRmFrZUlPU0FwcC5hcHAuemlwJyksICcud3JvbmcnKS5zaG91bGQuYmUucmVqZWN0ZWRXaXRoKFxuICAgICAgICAvZGlkIG5vdCBoYXZlIGV4dGVuc2lvbi9cbiAgICAgICk7XG4gICAgfSk7XG4gICAgZGVzY3JpYmUoJ3Nob3VsZCBkb3dubG9hZCBhbiBhcHAgZnJvbSB0aGUgd2ViJywgZnVuY3Rpb24gKCkge1xuICAgICAgbGV0IHBvcnQ7XG4gICAgICBsZXQgc2VydmVyVXJsO1xuXG4gICAgICBiZWZvcmUoYXN5bmMgZnVuY3Rpb24gKCkge1xuICAgICAgICBwb3J0ID0gYXdhaXQgZ2V0VGVzdFBvcnQodHJ1ZSk7XG4gICAgICAgIHNlcnZlclVybCA9IGBodHRwOi8vJHtURVNUX0hPU1R9OiR7cG9ydH1gO1xuICAgICAgfSk7XG5cbiAgICAgIGRlc2NyaWJlKCdzZXJ2ZXIgbm90IGF2YWlsYWJsZScsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaXQoJ3Nob3VsZCBoYW5kbGUgc2VydmVyIG5vdCBhdmFpbGFibGUnLCBhc3luYyBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgYXdhaXQgY29uZmlndXJlQXBwKFxuICAgICAgICAgICAgYCR7c2VydmVyVXJsfS9GYWtlSU9TQXBwLmFwcC56aXBgLFxuICAgICAgICAgICAgJy5hcHAnXG4gICAgICAgICAgKS5zaG91bGQuZXZlbnR1YWxseS5iZS5yZWplY3RlZFdpdGgoL0VDT05OUkVGVVNFRC8pO1xuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgICAgZGVzY3JpYmUoJ3NlcnZlciBhdmFpbGFibGUnLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIC8vIHVzZSBhIGxvY2FsIHNlcnZlciBzbyB0aGVyZSBpcyBubyBkZXBlbmRlbmN5IG9uIHRoZSBpbnRlcm5ldFxuICAgICAgICBsZXQgc2VydmVyO1xuICAgICAgICBiZWZvcmUoZnVuY3Rpb24gKCkge1xuICAgICAgICAgIGNvbnN0IGRpciA9IHBhdGgucmVzb2x2ZShfX2Rpcm5hbWUsICcuLicsICdmaXh0dXJlcycpO1xuICAgICAgICAgIGNvbnN0IHNlcnZlID0gc2VydmVTdGF0aWMoZGlyLCB7XG4gICAgICAgICAgICBpbmRleDogZmFsc2UsXG4gICAgICAgICAgICBzZXRIZWFkZXJzOiAocmVzLCBwYXRoKSA9PiB7XG4gICAgICAgICAgICAgIHJlcy5zZXRIZWFkZXIoJ0NvbnRlbnQtRGlzcG9zaXRpb24nLCBjb250ZW50RGlzcG9zaXRpb24ocGF0aCkpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICB9KTtcblxuICAgICAgICAgIHNlcnZlciA9IGh0dHAuY3JlYXRlU2VydmVyKGZ1bmN0aW9uIChyZXEsIHJlcykge1xuICAgICAgICAgICAgaWYgKHJlcS51cmwuaW5kZXhPZignbWlzc2luZycpICE9PSAtMSkge1xuICAgICAgICAgICAgICByZXMud3JpdGVIZWFkKDQwNCk7XG4gICAgICAgICAgICAgIHJlcy5lbmQoKTtcbiAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gZm9yIHRlc3RpbmcgemlwIGZpbGUgY29udGVudCB0eXBlc1xuICAgICAgICAgICAgY29uc3QgY29udGVudFR5cGUgPSBuZXcgVVJMU2VhcmNoUGFyYW1zKHVybC5wYXJzZShyZXEudXJsKS5zZWFyY2gpLmdldCgnY29udGVudC10eXBlJyk7XG4gICAgICAgICAgICBpZiAoY29udGVudFR5cGUgIT09IG51bGwpIHtcbiAgICAgICAgICAgICAgcmVzLnNldEhlYWRlcignY29udGVudC10eXBlJywgY29udGVudFR5cGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgc2VydmUocmVxLCByZXMsIGZpbmFsaGFuZGxlcihyZXEsIHJlcykpO1xuICAgICAgICAgIH0pO1xuICAgICAgICAgIGNvbnN0IGNsb3NlID0gc2VydmVyLmNsb3NlLmJpbmQoc2VydmVyKTtcbiAgICAgICAgICBzZXJ2ZXIuY2xvc2UgPSBhc3luYyBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAvLyBwYXVzZSBhIG1vbWVudCBvciB3ZSBnZXQgRUNPTlJFU0VUIGVycm9yc1xuICAgICAgICAgICAgYXdhaXQgQi5kZWxheSgxMDAwKTtcbiAgICAgICAgICAgIHJldHVybiBhd2FpdCBuZXcgQigocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICAgICAgICAgIHNlcnZlci5vbignY2xvc2UnLCByZXNvbHZlKTtcbiAgICAgICAgICAgICAgY2xvc2UoKGVycikgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChlcnIpIHJlamVjdChlcnIpOyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIGN1cmx5XG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfTtcbiAgICAgICAgICBzZXJ2ZXIubGlzdGVuKHBvcnQpO1xuICAgICAgICB9KTtcbiAgICAgICAgYWZ0ZXIoYXN5bmMgZnVuY3Rpb24gKCkge1xuICAgICAgICAgIGF3YWl0IHNlcnZlci5jbG9zZSgpO1xuICAgICAgICB9KTtcblxuICAgICAgICBpdCgnc2hvdWxkIGRvd25sb2FkIHppcCBmaWxlJywgYXN5bmMgZnVuY3Rpb24gKCkge1xuICAgICAgICAgIGxldCBuZXdBcHBQYXRoID0gYXdhaXQgY29uZmlndXJlQXBwKGAke3NlcnZlclVybH0vRmFrZUlPU0FwcC5hcHAuemlwYCwgJy5hcHAnKTtcbiAgICAgICAgICBuZXdBcHBQYXRoLnNob3VsZC5jb250YWluKCdGYWtlSU9TQXBwLmFwcCcpO1xuICAgICAgICAgIGxldCBjb250ZW50cyA9IGF3YWl0IGZzLnJlYWRGaWxlKG5ld0FwcFBhdGgsICd1dGY4Jyk7XG4gICAgICAgICAgY29udGVudHMuc2hvdWxkLmVxbCgndGhpcyBpcyBub3QgcmVhbGx5IGFuIGFwcFxcbicpO1xuICAgICAgICB9KTtcbiAgICAgICAgaXQoJ3Nob3VsZCBkb3dubG9hZCB6aXAgZmlsZSB3aXRoIHF1ZXJ5IHN0cmluZycsIGFzeW5jIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICBsZXQgbmV3QXBwUGF0aCA9IGF3YWl0IGNvbmZpZ3VyZUFwcChcbiAgICAgICAgICAgIGAke3NlcnZlclVybH0vRmFrZUlPU0FwcC5hcHAuemlwP3N2PWFiYyZzcj1kZWZgLFxuICAgICAgICAgICAgJy5hcHAnXG4gICAgICAgICAgKTtcbiAgICAgICAgICBuZXdBcHBQYXRoLnNob3VsZC5jb250YWluKCcuYXBwJyk7XG4gICAgICAgICAgbGV0IGNvbnRlbnRzID0gYXdhaXQgZnMucmVhZEZpbGUobmV3QXBwUGF0aCwgJ3V0ZjgnKTtcbiAgICAgICAgICBjb250ZW50cy5zaG91bGQuZXFsKCd0aGlzIGlzIG5vdCByZWFsbHkgYW4gYXBwXFxuJyk7XG4gICAgICAgIH0pO1xuICAgICAgICBpdCgnc2hvdWxkIGRvd25sb2FkIGFuIGFwcCBmaWxlJywgYXN5bmMgZnVuY3Rpb24gKCkge1xuICAgICAgICAgIGxldCBuZXdBcHBQYXRoID0gYXdhaXQgY29uZmlndXJlQXBwKGAke3NlcnZlclVybH0vRmFrZUlPU0FwcC5hcHBgLCAnLmFwcCcpO1xuICAgICAgICAgIG5ld0FwcFBhdGguc2hvdWxkLmNvbnRhaW4oJy5hcHAnKTtcbiAgICAgICAgICBsZXQgY29udGVudHMgPSBhd2FpdCBmcy5yZWFkRmlsZShuZXdBcHBQYXRoLCAndXRmOCcpO1xuICAgICAgICAgIGNvbnRlbnRzLnNob3VsZC5lcWwoJ3RoaXMgaXMgbm90IHJlYWxseSBhbiBhcHBcXG4nKTtcbiAgICAgICAgfSk7XG4gICAgICAgIGl0KCdzaG91bGQgYWNjZXB0IG11bHRpcGxlIGV4dGVuc2lvbnMnLCBhc3luYyBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgbGV0IG5ld0FwcFBhdGggPSBhd2FpdCBjb25maWd1cmVBcHAoYCR7c2VydmVyVXJsfS9GYWtlSU9TQXBwLmFwcC56aXBgLCBbJy5hcHAnLCAnLmFhYiddKTtcbiAgICAgICAgICBuZXdBcHBQYXRoLnNob3VsZC5jb250YWluKCdGYWtlSU9TQXBwLmFwcCcpO1xuICAgICAgICAgIGxldCBjb250ZW50cyA9IGF3YWl0IGZzLnJlYWRGaWxlKG5ld0FwcFBhdGgsICd1dGY4Jyk7XG4gICAgICAgICAgY29udGVudHMuc2hvdWxkLmVxbCgndGhpcyBpcyBub3QgcmVhbGx5IGFuIGFwcFxcbicpO1xuICAgICAgICB9KTtcbiAgICAgICAgaXQoJ3Nob3VsZCBkb3dubG9hZCBhbiBhcGsgZmlsZScsIGFzeW5jIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICBsZXQgbmV3QXBwUGF0aCA9IGF3YWl0IGNvbmZpZ3VyZUFwcChgJHtzZXJ2ZXJVcmx9L0Zha2VBbmRyb2lkQXBwLmFwa2AsICcuYXBrJyk7XG4gICAgICAgICAgbmV3QXBwUGF0aC5zaG91bGQuY29udGFpbignLmFwaycpO1xuICAgICAgICAgIGxldCBjb250ZW50cyA9IGF3YWl0IGZzLnJlYWRGaWxlKG5ld0FwcFBhdGgsICd1dGY4Jyk7XG4gICAgICAgICAgY29udGVudHMuc2hvdWxkLmVxbCgndGhpcyBpcyBub3QgcmVhbGx5IGFuIGFwa1xcbicpO1xuICAgICAgICB9KTtcbiAgICAgICAgaXQoJ3Nob3VsZCBoYW5kbGUgemlwIGZpbGUgdGhhdCBjYW5ub3QgYmUgZG93bmxvYWRlZCcsIGFzeW5jIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICBhd2FpdCBjb25maWd1cmVBcHAoYCR7c2VydmVyVXJsfS9taXNzaW5nL0Zha2VJT1NBcHAuYXBwLnppcGAsICcuYXBwJykuc2hvdWxkLmV2ZW50dWFsbHkuYmVcbiAgICAgICAgICAgIC5yZWplY3RlZDtcbiAgICAgICAgfSk7XG4gICAgICAgIGl0KCdzaG91bGQgaGFuZGxlIGludmFsaWQgcHJvdG9jb2wnLCBhc3luYyBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgYXdhaXQgY29uZmlndXJlQXBwKFxuICAgICAgICAgICAgJ2ZpbGU6Ly9DOi9taXNzaW5nL0Zha2VJT1NBcHAuYXBwLnppcCcsXG4gICAgICAgICAgICAnLmFwcCdcbiAgICAgICAgICApLnNob3VsZC5ldmVudHVhbGx5LmJlLnJlamVjdGVkV2l0aCgvaXMgbm90IHN1cHBvcnRlZC8pO1xuICAgICAgICAgIGF3YWl0IGNvbmZpZ3VyZUFwcChcbiAgICAgICAgICAgIGBmdHA6Ly8ke1RFU1RfSE9TVH06JHtwb3J0fS9taXNzaW5nL0Zha2VJT1NBcHAuYXBwLnppcGAsXG4gICAgICAgICAgICAnLmFwcCdcbiAgICAgICAgICApLnNob3VsZC5ldmVudHVhbGx5LmJlLnJlamVjdGVkV2l0aCgvaXMgbm90IHN1cHBvcnRlZC8pO1xuICAgICAgICB9KTtcbiAgICAgICAgaXQoJ3Nob3VsZCBoYW5kbGUgbWlzc2luZyBmaWxlIGluIFdpbmRvd3MgcGF0aCBmb3JtYXQnLCBhc3luYyBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgYXdhaXQgY29uZmlndXJlQXBwKFxuICAgICAgICAgICAgJ0M6XFxcXG1pc3NpbmdcXFxcRmFrZUlPU0FwcC5hcHAuemlwJyxcbiAgICAgICAgICAgICcuYXBwJ1xuICAgICAgICAgICkuc2hvdWxkLmV2ZW50dWFsbHkuYmUucmVqZWN0ZWRXaXRoKC9kb2VzIG5vdCBleGlzdCBvciBpcyBub3QgYWNjZXNzaWJsZS8pO1xuICAgICAgICB9KTtcbiAgICAgICAgaXQoJ3Nob3VsZCByZWNvZ25pemUgemlwIG1pbWUgdHlwZXMgYW5kIHVuemlwIHRoZSBkb3dubG9hZGVkIGZpbGUnLCBhc3luYyBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgbGV0IG5ld0FwcFBhdGggPSBhd2FpdCBjb25maWd1cmVBcHAoXG4gICAgICAgICAgICBgJHtzZXJ2ZXJVcmx9L0Zha2VBbmRyb2lkQXBwLmFzZD9jb250ZW50LXR5cGU9JHtlbmNvZGVVUklDb21wb25lbnQoJ2FwcGxpY2F0aW9uL3ppcCcpfWAsXG4gICAgICAgICAgICAnLmFwaydcbiAgICAgICAgICApO1xuICAgICAgICAgIG5ld0FwcFBhdGguc2hvdWxkLmNvbnRhaW4oJ0Zha2VBbmRyb2lkQXBwLmFwaycpO1xuICAgICAgICAgIG5ld0FwcFBhdGguc2hvdWxkLm5vdC5jb250YWluKCcuYXNkJyk7XG4gICAgICAgICAgbGV0IGNvbnRlbnRzID0gYXdhaXQgZnMucmVhZEZpbGUobmV3QXBwUGF0aCwgJ3V0ZjgnKTtcbiAgICAgICAgICBjb250ZW50cy5zaG91bGQuZXFsKCd0aGlzIGlzIG5vdCByZWFsbHkgYW4gYXBrXFxuJyk7XG4gICAgICAgIH0pO1xuICAgICAgICBpdCgnc2hvdWxkIHJlY29nbml6ZSB6aXAgbWltZSB0eXBlcyB3aXRoIHBhcmFtZXRlciBhbmQgdW56aXAgdGhlIGRvd25sb2FkZWQgZmlsZScsIGFzeW5jIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICBsZXQgbmV3QXBwUGF0aCA9IGF3YWl0IGNvbmZpZ3VyZUFwcChcbiAgICAgICAgICAgIGAke3NlcnZlclVybH0vRmFrZUFuZHJvaWRBcHAuYXNkP2NvbnRlbnQtdHlwZT0ke2VuY29kZVVSSUNvbXBvbmVudChcbiAgICAgICAgICAgICAgJ2FwcGxpY2F0aW9uL3ppcDsgcGFyYW1ldGVyPXZhbHVlJ1xuICAgICAgICAgICAgKX1gLFxuICAgICAgICAgICAgJy5hcGsnXG4gICAgICAgICAgKTtcbiAgICAgICAgICBuZXdBcHBQYXRoLnNob3VsZC5jb250YWluKCdGYWtlQW5kcm9pZEFwcC5hcGsnKTtcbiAgICAgICAgICBuZXdBcHBQYXRoLnNob3VsZC5ub3QuY29udGFpbignLmFzZCcpO1xuICAgICAgICAgIGxldCBjb250ZW50cyA9IGF3YWl0IGZzLnJlYWRGaWxlKG5ld0FwcFBhdGgsICd1dGY4Jyk7XG4gICAgICAgICAgY29udGVudHMuc2hvdWxkLmVxbCgndGhpcyBpcyBub3QgcmVhbGx5IGFuIGFwa1xcbicpO1xuICAgICAgICB9KTtcbiAgICAgICAgaXQoJ3Nob3VsZCByZWNvZ25pemUgemlwIG1pbWUgdHlwZXMgYW5kIHVuemlwIHRoZSBkb3dubG9hZGVkIGZpbGUgd2l0aCBxdWVyeSBzdHJpbmcnLCBhc3luYyBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgbGV0IG5ld0FwcFBhdGggPSBhd2FpdCBjb25maWd1cmVBcHAoXG4gICAgICAgICAgICBgJHtzZXJ2ZXJVcmx9L0Zha2VBbmRyb2lkQXBwLmFzZD9jb250ZW50LXR5cGU9JHtlbmNvZGVVUklDb21wb25lbnQoXG4gICAgICAgICAgICAgICdhcHBsaWNhdGlvbi96aXAnXG4gICAgICAgICAgICApfSZzdj1hYmMmc3I9ZGVmYCxcbiAgICAgICAgICAgICcuYXBrJ1xuICAgICAgICAgICk7XG4gICAgICAgICAgbmV3QXBwUGF0aC5zaG91bGQuY29udGFpbignRmFrZUFuZHJvaWRBcHAuYXBrJyk7XG4gICAgICAgICAgbmV3QXBwUGF0aC5zaG91bGQubm90LmNvbnRhaW4oJy5hc2QnKTtcbiAgICAgICAgICBsZXQgY29udGVudHMgPSBhd2FpdCBmcy5yZWFkRmlsZShuZXdBcHBQYXRoLCAndXRmOCcpO1xuICAgICAgICAgIGNvbnRlbnRzLnNob3VsZC5lcWwoJ3RoaXMgaXMgbm90IHJlYWxseSBhbiBhcGtcXG4nKTtcbiAgICAgICAgfSk7XG4gICAgICAgIGl0KCdzaG91bGQgdHJlYXQgYW4gdW5rbm93biBtaW1lIHR5cGUgYXMgYW4gYXBwJywgYXN5bmMgZnVuY3Rpb24gKCkge1xuICAgICAgICAgIGxldCBuZXdBcHBQYXRoID0gYXdhaXQgY29uZmlndXJlQXBwKFxuICAgICAgICAgICAgYCR7c2VydmVyVXJsfS9GYWtlQW5kcm9pZEFwcC5hcGs/Y29udGVudC10eXBlPSR7ZW5jb2RlVVJJQ29tcG9uZW50KCdhcHBsaWNhdGlvbi9iaXAnKX1gLFxuICAgICAgICAgICAgJy5hcGsnXG4gICAgICAgICAgKTtcbiAgICAgICAgICBuZXdBcHBQYXRoLnNob3VsZC5jb250YWluKCcuYXBrJyk7XG4gICAgICAgICAgbGV0IGNvbnRlbnRzID0gYXdhaXQgZnMucmVhZEZpbGUobmV3QXBwUGF0aCwgJ3V0ZjgnKTtcbiAgICAgICAgICBjb250ZW50cy5zaG91bGQuZXFsKCd0aGlzIGlzIG5vdCByZWFsbHkgYW4gYXBrXFxuJyk7XG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH0pO1xufSk7XG4iXSwibWFwcGluZ3MiOiI7Ozs7OztBQUFBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUVBLFNBQVNBLFVBQVQsQ0FBb0JDLElBQXBCLEVBQTBCO0VBRXhCLE9BQU9DLGFBQUEsQ0FBS0MsT0FBTCxDQUFhQyxTQUFiLEVBQXdCLElBQXhCLEVBQThCLFVBQTlCLEVBQTBDSCxJQUExQyxDQUFQO0FBQ0Q7O0FBRURJLFFBQVEsQ0FBQyxnQ0FBRCxFQUFtQyxZQUFZO0VBQ3JEQSxRQUFRLENBQUMsY0FBRCxFQUFpQixZQUFZO0lBQ25DQyxFQUFFLENBQUMsc0NBQUQsRUFBeUMsa0JBQWtCO01BQzNELElBQUlDLFVBQVUsR0FBRyxNQUFNLElBQUFDLHFCQUFBLEVBQWFSLFVBQVUsQ0FBQyxnQkFBRCxDQUF2QixFQUEyQyxNQUEzQyxDQUF2QjtNQUNB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
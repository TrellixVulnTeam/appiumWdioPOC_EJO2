"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

require("source-map-support/register");

var _log = require("../../../../lib/basedriver/commands/log");

var _sinon = require("sinon");

var _lodash = _interopRequireDefault(require("lodash"));

const expect = chai.expect;
const FIRST_LOGS = ['first', 'logs'];
const SECOND_LOGS = ['second', 'logs'];
const SUPPORTED_LOG_TYPES = {
  one: {
    description: 'First logs',
    getter: () => _lodash.default.clone(FIRST_LOGS)
  },
  two: {
    description: 'Seconds logs',
    getter: () => _lodash.default.clone(SECOND_LOGS)
  }
};
describe('log commands -', function () {
  let sandbox;
  let LogCommands;
  let logCommands;
  beforeEach(function () {
    sandbox = (0, _sinon.createSandbox)();
    LogCommands = (0, _log.LogMixin)(class {
      get log() {
        return this._log;
      }

    });
    logCommands = new LogCommands();
    logCommands.supportedLogTypes = {};
    logCommands._log = {
      debug: _lodash.default.noop
    };
  });
  afterEach(function () {
    sandbox.restore();
  });
  describe('getLogTypes', function () {
    it('should return empty array when no supported log types', async function () {
      (await logCommands.getLogTypes()).should.eql([]);
    });
    it('should return keys to log type object', async function () {
      logCommands.supportedLogTypes = SUPPORTED_LOG_TYPES;
      (await logCommands.getLogTypes()).should.eql(['one', 'two']);
    });
  });
  describe('getLog', function () {
    let one;
    let two;
    beforeEach(function () {
      one = sandbox.spy(SUPPORTED_LOG_TYPES.one, 'getter');
      two = sandbox.spy(SUPPORTED_LOG_TYPES.two, 'getter');
    });
    it('should throw error if log type not supported', async function () {
      await logCommands.getLog('one').should.eventually.be.rejected;
      one.called.should.be.false;
      two.called.should.be.false;
    });
    it('should throw an error with available log types if log type not supported', async function () {
      logCommands.supportedLogTypes = SUPPORTED_LOG_TYPES;
      let err;

      try {
        await logCommands.getLog('three');
      } catch (_err) {
        err = _err;
      }

      expect(err).to.exist;
      err.message.should.eql(`Unsupported log type 'three'. Supported types: {"one":"First logs","two":"Seconds logs"}`);
      one.called.should.be.false;
      two.called.should.be.false;
    });
    it('should call getter on appropriate log when found', async function () {
      logCommands.supportedLogTypes = SUPPORTED_LOG_TYPES;
      let logs = await logCommands.getLog('one');
      logs.should.eql(FIRST_LOGS);
      one.called.should.be.true;
      two.called.should.be.false;
    });
  });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJleHBlY3QiLCJjaGFpIiwiRklSU1RfTE9HUyIsIlNFQ09ORF9MT0dTIiwiU1VQUE9SVEVEX0xPR19UWVBFUyIsIm9uZSIsImRlc2NyaXB0aW9uIiwiZ2V0dGVyIiwiXyIsImNsb25lIiwidHdvIiwiZGVzY3JpYmUiLCJzYW5kYm94IiwiTG9nQ29tbWFuZHMiLCJsb2dDb21tYW5kcyIsImJlZm9yZUVhY2giLCJjcmVhdGVTYW5kYm94IiwiTG9nTWl4aW4iLCJsb2ciLCJfbG9nIiwic3VwcG9ydGVkTG9nVHlwZXMiLCJkZWJ1ZyIsIm5vb3AiLCJhZnRlckVhY2giLCJyZXN0b3JlIiwiaXQiLCJnZXRMb2dUeXBlcyIsInNob3VsZCIsImVxbCIsInNweSIsImdldExvZyIsImV2ZW50dWFsbHkiLCJiZSIsInJlamVjdGVkIiwiY2FsbGVkIiwiZmFsc2UiLCJlcnIiLCJfZXJyIiwidG8iLCJleGlzdCIsIm1lc3NhZ2UiLCJsb2dzIiwidHJ1ZSJdLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uL3Rlc3QvdW5pdC9iYXNlZHJpdmVyL2NvbW1hbmRzL2xvZy5zcGVjLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIEB0cy1jaGVja1xuaW1wb3J0IHtMb2dNaXhpbn0gZnJvbSAnLi4vLi4vLi4vLi4vbGliL2Jhc2Vkcml2ZXIvY29tbWFuZHMvbG9nJztcbmltcG9ydCB7Y3JlYXRlU2FuZGJveH0gZnJvbSAnc2lub24nO1xuaW1wb3J0IF8gZnJvbSAnbG9kYXNoJztcblxuY29uc3QgZXhwZWN0ID0gY2hhaS5leHBlY3Q7XG5cbmNvbnN0IEZJUlNUX0xPR1MgPSBbJ2ZpcnN0JywgJ2xvZ3MnXTtcbmNvbnN0IFNFQ09ORF9MT0dTID0gWydzZWNvbmQnLCAnbG9ncyddO1xuY29uc3QgU1VQUE9SVEVEX0xPR19UWVBFUyA9IHtcbiAgb25lOiB7XG4gICAgZGVzY3JpcHRpb246ICdGaXJzdCBsb2dzJyxcbiAgICBnZXR0ZXI6ICgpID0+IF8uY2xvbmUoRklSU1RfTE9HUyksXG4gIH0sXG4gIHR3bzoge1xuICAgIGRlc2NyaXB0aW9uOiAnU2Vjb25kcyBsb2dzJyxcbiAgICBnZXR0ZXI6ICgpID0+IF8uY2xvbmUoU0VDT05EX0xPR1MpLFxuICB9LFxufTtcblxuZGVzY3JpYmUoJ2xvZyBjb21tYW5kcyAtJywgZnVuY3Rpb24gKCkge1xuICBsZXQgc2FuZGJveDtcbiAgLyoqIEB0eXBlIHtSZXR1cm5UeXBlPHR5cGVvZiBMb2dNaXhpbj59ICovXG4gIGxldCBMb2dDb21tYW5kcztcblxuICBsZXQgbG9nQ29tbWFuZHM7XG5cbiAgYmVmb3JlRWFjaChmdW5jdGlvbiAoKSB7XG4gICAgc2FuZGJveCA9IGNyZWF0ZVNhbmRib3goKTtcbiAgICAvLyBAdHMtZXhwZWN0LWVycm9yXG4gICAgTG9nQ29tbWFuZHMgPSBMb2dNaXhpbihcbiAgICAgIGNsYXNzIHtcbiAgICAgICAgZ2V0IGxvZygpIHtcbiAgICAgICAgICByZXR1cm4gdGhpcy5fbG9nO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgKTtcbiAgICBsb2dDb21tYW5kcyA9IG5ldyBMb2dDb21tYW5kcygpO1xuICAgIC8vIHJlc2V0IHRoZSBzdXBwb3J0ZWQgbG9nIHR5cGVzXG4gICAgbG9nQ29tbWFuZHMuc3VwcG9ydGVkTG9nVHlwZXMgPSB7fTtcbiAgICBsb2dDb21tYW5kcy5fbG9nID0gLyoqIEB0eXBlIHtpbXBvcnQoJ0BhcHBpdW0vdHlwZXMnKS5BcHBpdW1Mb2dnZXJ9ICovICh7XG4gICAgICBkZWJ1ZzogXy5ub29wLFxuICAgIH0pO1xuICB9KTtcblxuICBhZnRlckVhY2goZnVuY3Rpb24gKCkge1xuICAgIHNhbmRib3gucmVzdG9yZSgpO1xuICB9KTtcblxuICBkZXNjcmliZSgnZ2V0TG9nVHlwZXMnLCBmdW5jdGlvbiAoKSB7XG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gZW1wdHkgYXJyYXkgd2hlbiBubyBzdXBwb3J0ZWQgbG9nIHR5cGVzJywgYXN5bmMgZnVuY3Rpb24gKCkge1xuICAgICAgKGF3YWl0IGxvZ0NvbW1hbmRzLmdldExvZ1R5cGVzKCkpLnNob3VsZC5lcWwoW10pO1xuICAgIH0pO1xuICAgIGl0KCdzaG91bGQgcmV0dXJuIGtleXMgdG8gbG9nIHR5cGUgb2JqZWN0JywgYXN5bmMgZnVuY3Rpb24gKCkge1xuICAgICAgbG9nQ29tbWFuZHMuc3VwcG9ydGVkTG9nVHlwZXMgPSBTVVBQT1JURURfTE9HX1RZUEVTO1xuICAgICAgKGF3YWl0IGxvZ0NvbW1hbmRzLmdldExvZ1R5cGVzKCkpLnNob3VsZC5lcWwoWydvbmUnLCAndHdvJ10pO1xuICAgIH0pO1xuICB9KTtcbiAgZGVzY3JpYmUoJ2dldExvZycsIGZ1bmN0aW9uICgpIHtcbiAgICAvKiogQHR5cGUge3Npbm9uLlNpbm9uU3BpZWRNZW1iZXI8dHlwZW9mIFNVUFBPUlRFRF9MT0dfVFlQRVMub25lLmdldHRlcj59ICovXG4gICAgbGV0IG9uZTtcbiAgICAvKiogQHR5cGUge3Npbm9uLlNpbm9uU3BpZWRNZW1iZXI8dHlwZW9mIFNVUFBPUlRFRF9MT0dfVFlQRVMudHdvLmdldHRlcj59ICovXG4gICAgbGV0IHR3bztcbiAgICBiZWZvcmVFYWNoKGZ1bmN0aW9uICgpIHtcbiAgICAgIG9uZSA9IHNhbmRib3guc3B5KFNVUFBPUlRFRF9MT0dfVFlQRVMub25lLCAnZ2V0dGVyJyk7XG4gICAgICB0d28gPSBzYW5kYm94LnNweShTVVBQT1JURURfTE9HX1RZUEVTLnR3bywgJ2dldHRlcicpO1xuICAgIH0pO1xuICAgIGl0KCdzaG91bGQgdGhyb3cgZXJyb3IgaWYgbG9nIHR5cGUgbm90IHN1cHBvcnRlZCcsIGFzeW5jIGZ1bmN0aW9uICgpIHtcbiAgICAgIGF3YWl0IGxvZ0NvbW1hbmRzLmdldExvZygnb25lJykuc2hvdWxkLmV2ZW50dWFsbHkuYmUucmVqZWN0ZWQ7XG4gICAgICBvbmUuY2FsbGVkLnNob3VsZC5iZS5mYWxzZTtcbiAgICAgIHR3by5jYWxsZWQuc2hvdWxkLmJlLmZhbHNlO1xuICAgIH0pO1xuICAgIGl0KCdzaG91bGQgdGhyb3cgYW4gZXJyb3Igd2l0aCBhdmFpbGFibGUgbG9nIHR5cGVzIGlmIGxvZyB0eXBlIG5vdCBzdXBwb3J0ZWQnLCBhc3luYyBmdW5jdGlvbiAoKSB7XG4gICAgICBsb2dDb21tYW5kcy5zdXBwb3J0ZWRMb2dUeXBlcyA9IFNVUFBPUlRFRF9MT0dfVFlQRVM7XG4gICAgICBsZXQgZXJyO1xuICAgICAgdHJ5IHtcbiAgICAgICAgYXdhaXQgbG9nQ29tbWFuZHMuZ2V0TG9nKCd0aHJlZScpO1xuICAgICAgfSBjYXRjaCAoX2Vycikge1xuICAgICAgICBlcnIgPSBfZXJyO1xuICAgICAgfVxuICAgICAgZXhwZWN0KGVycikudG8uZXhpc3Q7XG4gICAgICBlcnIubWVzc2FnZS5zaG91bGQuZXFsKFxuICAgICAgICBgVW5zdXBwb3J0ZWQgbG9nIHR5cGUgJ3RocmVlJy4gU3VwcG9ydGVkIHR5cGVzOiB7XCJvbmVcIjpcIkZpcnN0IGxvZ3NcIixcInR3b1wiOlwiU2Vjb25kcyBsb2dzXCJ9YFxuICAgICAgKTtcbiAgICAgIG9uZS5jYWxsZWQuc2hvdWxkLmJlLmZhbHNlO1xuICAgICAgdHdvLmNhbGxlZC5zaG91bGQuYmUuZmFsc2U7XG4gICAgfSk7XG4gICAgaXQoJ3Nob3VsZCBjYWxsIGdldHRlciBvbiBhcHByb3ByaWF0ZSBsb2cgd2hlbiBmb3VuZCcsIGFzeW5jIGZ1bmN0aW9uICgpIHtcbiAgICAgIGxvZ0NvbW1hbmRzLnN1cHBvcnRlZExvZ1R5cGVzID0gU1VQUE9SVEVEX0xPR19UWVBFUztcbiAgICAgIGxldCBsb2dzID0gYXdhaXQgbG9nQ29tbWFuZHMuZ2V0TG9nKCdvbmUnKTtcbiAgICAgIGxvZ3Muc2hvdWxkLmVxbChGSVJTVF9MT0dTKTtcbiAgICAgIG9uZS5jYWxsZWQuc2hvdWxkLmJlLnRydWU7XG4gICAgICB0d28uY2FsbGVkLnNob3VsZC5iZS5mYWxzZTtcbiAgICB9KTtcbiAgfSk7XG59KTtcbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBRUEsTUFBTUEsTUFBTSxHQUFHQyxJ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